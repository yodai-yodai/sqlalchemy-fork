<!DOCTYPE html>



<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <title>
            
    
    Microsoft SQL Server
 &mdash;
    SQLAlchemy 2.0 Documentation

        </title>

        
            <!-- begin iterate through site-imported + sphinx environment css_files -->
                <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
                <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
                <link rel="stylesheet" href="../_static/default.css" type="text/css" />
                <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
                <link rel="stylesheet" href="../_static/docs.css" type="text/css" />
                <link rel="stylesheet" href="../_static/changelog.css" type="text/css" />
                <link rel="stylesheet" href="../_static/sphinx_paramlinks.css" type="text/css" />
            <!-- end iterate through site-imported + sphinx environment css_files -->
        

        

    

    <!-- begin layout.mako headers -->

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
        <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="SQLAlchemy 2.0 Documentation" href="../index.html" />
        <link rel="up" title="Dialects" href="index.html" />
        <link rel="next" title="Frequently Asked Questions" href="../faq/index.html" />
        <link rel="prev" title="Oracle" href="oracle.html" />
    <!-- end layout.mako headers -->


    </head>
    <body>
        
















<div id="docs-container">





<div id="docs-top-navigation-container" class="body-background">
<div id="docs-header">
    <div id="docs-version-header">
        Release: <span class="version-num">2.0.31</span>


        | Release Date: June 18, 2024

    </div>

    <h1><a href="../index.html">SQLAlchemy 2.0 Documentation</a></h1>

</div>
</div>

<div id="docs-body-container">

    <div id="fixed-sidebar" class="withsidebar">



        <div id="docs-sidebar-popout">
            <h3><a href="../index.html">SQLAlchemy 2.0 Documentation</a></h3>
            <p id="sidebar-topnav">
                <a href="../index.html">Home</a>
            </p>

            <div id="sidebar-search">
                <form class="search" action="../search.html" method="get">
                  <label>
                  Search terms:
                  <input type="text" placeholder="search..." name="q" size="12" />
                  </label>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </div>

        </div>

        <div id="docs-sidebar">

        <div id="sidebar-banner">
            
        </div>

        <div id="docs-sidebar-inner">

        
        <h3>
            <a href="index.html" title="Dialects">Dialects</a>
        </h3>

        <ul>
<li><span class="link-container"><a class="reference external" href="postgresql.html">PostgreSQL</a></span></li>
<li><span class="link-container"><a class="reference external" href="mysql.html">MySQL and MariaDB</a></span></li>
<li><span class="link-container"><a class="reference external" href="sqlite.html">SQLite</a></span></li>
<li><span class="link-container"><a class="reference external" href="oracle.html">Oracle</a></span></li>
<li class="selected"><span class="link-container"><strong>Microsoft SQL Server</strong><a class="paramlink headerlink reference internal" href="#">¶</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#dialect-mssql">Support for the Microsoft SQL Server database.</a></span></li>
<li><span class="link-container"><a class="reference external" href="#external-dialects">External Dialects</a></span></li>
<li><span class="link-container"><a class="reference external" href="#auto-increment-behavior-identity-columns">Auto Increment Behavior / IDENTITY Columns</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#controlling-start-and-increment">Controlling “Start” and “Increment”</a></span></li>
<li><span class="link-container"><a class="reference external" href="#using-identity-with-non-integer-numeric-types">Using IDENTITY with Non-Integer numeric types</a></span></li>
<li><span class="link-container"><a class="reference external" href="#insert-behavior">INSERT behavior</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#sequence-support">SEQUENCE support</a></span></li>
<li><span class="link-container"><a class="reference external" href="#max-on-varchar-nvarchar">MAX on VARCHAR / NVARCHAR</a></span></li>
<li><span class="link-container"><a class="reference external" href="#collation-support">Collation Support</a></span></li>
<li><span class="link-container"><a class="reference external" href="#limit-offset-support">LIMIT/OFFSET Support</a></span></li>
<li><span class="link-container"><a class="reference external" href="#ddl-comment-support">DDL Comment Support</a></span></li>
<li><span class="link-container"><a class="reference external" href="#transaction-isolation-level">Transaction Isolation Level</a></span></li>
<li><span class="link-container"><a class="reference external" href="#temporary-table-resource-reset-for-connection-pooling">Temporary Table / Resource Reset for Connection Pooling</a></span></li>
<li><span class="link-container"><a class="reference external" href="#nullability">Nullability</a></span></li>
<li><span class="link-container"><a class="reference external" href="#date-time-handling">Date / Time Handling</a></span></li>
<li><span class="link-container"><a class="reference external" href="#large-text-binary-type-deprecation">Large Text/Binary Type Deprecation</a></span></li>
<li><span class="link-container"><a class="reference external" href="#multipart-schema-names">Multipart Schema Names</a></span></li>
<li><span class="link-container"><a class="reference external" href="#legacy-schema-mode">Legacy Schema Mode</a></span></li>
<li><span class="link-container"><a class="reference external" href="#clustered-index-support">Clustered Index Support</a></span></li>
<li><span class="link-container"><a class="reference external" href="#columnstore-index-support">Columnstore Index Support</a></span></li>
<li><span class="link-container"><a class="reference external" href="#mssql-specific-index-options">MSSQL-Specific Index Options</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#include">INCLUDE</a></span></li>
<li><span class="link-container"><a class="reference external" href="#filtered-indexes">Filtered Indexes</a></span></li>
<li><span class="link-container"><a class="reference external" href="#index-ordering">Index ordering</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#compatibility-levels">Compatibility Levels</a></span></li>
<li><span class="link-container"><a class="reference external" href="#triggers">Triggers</a></span></li>
<li><span class="link-container"><a class="reference external" href="#rowcount-support-orm-versioning">Rowcount Support / ORM Versioning</a></span></li>
<li><span class="link-container"><a class="reference external" href="#enabling-snapshot-isolation">Enabling Snapshot Isolation</a></span></li>
<li><span class="link-container"><a class="reference external" href="#sql-server-sql-constructs">SQL Server SQL Constructs</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.try_cast"><code class="docutils literal notranslate"><span class="pre">try_cast()</span></code></a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#sql-server-data-types">SQL Server Data Types</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.BIT"><code class="docutils literal notranslate"><span class="pre">BIT</span></code></a></span><ul>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.BIT.__init__"><code class="docutils literal notranslate"><span class="pre">BIT.__init__()</span></code></a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.DATETIME2"><code class="docutils literal notranslate"><span class="pre">DATETIME2</span></code></a></span></li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.DATETIMEOFFSET"><code class="docutils literal notranslate"><span class="pre">DATETIMEOFFSET</span></code></a></span></li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.DOUBLE_PRECISION"><code class="docutils literal notranslate"><span class="pre">DOUBLE_PRECISION</span></code></a></span></li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.IMAGE"><code class="docutils literal notranslate"><span class="pre">IMAGE</span></code></a></span><ul>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.IMAGE.__init__"><code class="docutils literal notranslate"><span class="pre">IMAGE.__init__()</span></code></a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.JSON"><code class="docutils literal notranslate"><span class="pre">JSON</span></code></a></span><ul>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.JSON.__init__"><code class="docutils literal notranslate"><span class="pre">JSON.__init__()</span></code></a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.MONEY"><code class="docutils literal notranslate"><span class="pre">MONEY</span></code></a></span></li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.NTEXT"><code class="docutils literal notranslate"><span class="pre">NTEXT</span></code></a></span><ul>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.NTEXT.__init__"><code class="docutils literal notranslate"><span class="pre">NTEXT.__init__()</span></code></a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.REAL"><code class="docutils literal notranslate"><span class="pre">REAL</span></code></a></span></li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.ROWVERSION"><code class="docutils literal notranslate"><span class="pre">ROWVERSION</span></code></a></span><ul>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.ROWVERSION.__init__"><code class="docutils literal notranslate"><span class="pre">ROWVERSION.__init__()</span></code></a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.SMALLDATETIME"><code class="docutils literal notranslate"><span class="pre">SMALLDATETIME</span></code></a></span><ul>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.SMALLDATETIME.__init__"><code class="docutils literal notranslate"><span class="pre">SMALLDATETIME.__init__()</span></code></a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.SMALLMONEY"><code class="docutils literal notranslate"><span class="pre">SMALLMONEY</span></code></a></span></li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.SQL_VARIANT"><code class="docutils literal notranslate"><span class="pre">SQL_VARIANT</span></code></a></span></li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.TIME"><code class="docutils literal notranslate"><span class="pre">TIME</span></code></a></span></li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.TIMESTAMP"><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></a></span><ul>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.TIMESTAMP.__init__"><code class="docutils literal notranslate"><span class="pre">TIMESTAMP.__init__()</span></code></a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.TINYINT"><code class="docutils literal notranslate"><span class="pre">TINYINT</span></code></a></span></li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER"><code class="docutils literal notranslate"><span class="pre">UNIQUEIDENTIFIER</span></code></a></span><ul>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER.__init__"><code class="docutils literal notranslate"><span class="pre">UNIQUEIDENTIFIER.__init__()</span></code></a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.XML"><code class="docutils literal notranslate"><span class="pre">XML</span></code></a></span><ul>
<li><span class="link-container"><a class="reference external" href="#sqlalchemy.dialects.mssql.XML.__init__"><code class="docutils literal notranslate"><span class="pre">XML.__init__()</span></code></a></span></li>
</ul>
</li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#module-sqlalchemy.dialects.mssql.pyodbc">PyODBC</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#dialect-mssql-pyodbc-url">DBAPI</a></span></li>
<li><span class="link-container"><a class="reference external" href="#dialect-mssql-pyodbc-connect">Connecting</a></span></li>
<li><span class="link-container"><a class="reference external" href="#connecting-to-pyodbc">Connecting to PyODBC</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#dsn-connections">DSN Connections</a></span></li>
<li><span class="link-container"><a class="reference external" href="#hostname-connections">Hostname Connections</a></span></li>
<li><span class="link-container"><a class="reference external" href="#pass-through-exact-pyodbc-string">Pass through exact Pyodbc string</a></span></li>
<li><span class="link-container"><a class="reference external" href="#connecting-to-databases-with-access-tokens">Connecting to databases with access tokens</a></span></li>
<li><span class="link-container"><a class="reference external" href="#avoiding-transaction-related-exceptions-on-azure-synapse-analytics">Avoiding transaction-related exceptions on Azure Synapse Analytics</a></span></li>
<li><span class="link-container"><a class="reference external" href="#enable-autocommit-for-azure-sql-data-warehouse-dw-connections">Enable autocommit for Azure SQL Data Warehouse (DW) connections</a></span></li>
<li><span class="link-container"><a class="reference external" href="#avoiding-sending-large-string-parameters-as-text-ntext">Avoiding sending large string parameters as TEXT/NTEXT</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#pyodbc-pooling-connection-close-behavior">Pyodbc Pooling / connection close behavior</a></span></li>
<li><span class="link-container"><a class="reference external" href="#driver-unicode-support">Driver / Unicode Support</a></span></li>
<li><span class="link-container"><a class="reference external" href="#rowcount-support">Rowcount Support</a></span></li>
<li><span class="link-container"><a class="reference external" href="#fast-executemany-mode">Fast Executemany Mode</a></span></li>
<li><span class="link-container"><a class="reference external" href="#setinputsizes-support">Setinputsizes Support</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#module-sqlalchemy.dialects.mssql.pymssql">pymssql</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#dialect-mssql-pymssql-connect">Connecting</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="#module-sqlalchemy.dialects.mssql.aioodbc">aioodbc</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#dialect-mssql-aioodbc-url">DBAPI</a></span></li>
<li><span class="link-container"><a class="reference external" href="#dialect-mssql-aioodbc-connect">Connecting</a></span></li>
</ul>
</li>
</ul>
</li>
</ul>



        </div>

        </div>

    </div>

    <div id="narrow-index-nav">
        <form class="search" action="../search.html" method="get">
            <label>
                Search terms:
            <input type="text" placeholder="search..." name="q" size="12" />
            </label>
            <input type="submit" value="Search" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
        </form>

        <p>
        <a href="../index.html">Home</a>
        </p>

    </div>


        <div id="docs-narrow-top-navigation">
            <ul>
                <li><b>Previous:</b>
                <a href="oracle.html" title="previous chapter">Oracle</a></li>
                <li><b>Next:</b>
                <a href="../faq/index.html" title="next chapter">Frequently Asked Questions</a></li>

            <li><b>Up:</b> <a href="../index.html">Home</a></li>
                    <ul><li><a href="index.html" title="Dialects">Dialects</a></li>
                </ul>



            <li><b>On this page:</b></li>
            <ul>
<li><a class="reference internal" href="#module-sqlalchemy.dialects.mssql.base">Microsoft SQL Server</a><ul>
<li><a class="reference internal" href="#dialect-mssql">Support for the Microsoft SQL Server database.</a></li>
<li><a class="reference internal" href="#external-dialects">External Dialects</a></li>
<li><a class="reference internal" href="#auto-increment-behavior-identity-columns">Auto Increment Behavior / IDENTITY Columns</a><ul>
<li><a class="reference internal" href="#controlling-start-and-increment">Controlling “Start” and “Increment”</a></li>
<li><a class="reference internal" href="#using-identity-with-non-integer-numeric-types">Using IDENTITY with Non-Integer numeric types</a></li>
<li><a class="reference internal" href="#insert-behavior">INSERT behavior</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sequence-support">SEQUENCE support</a></li>
<li><a class="reference internal" href="#max-on-varchar-nvarchar">MAX on VARCHAR / NVARCHAR</a></li>
<li><a class="reference internal" href="#collation-support">Collation Support</a></li>
<li><a class="reference internal" href="#limit-offset-support">LIMIT/OFFSET Support</a></li>
<li><a class="reference internal" href="#ddl-comment-support">DDL Comment Support</a></li>
<li><a class="reference internal" href="#transaction-isolation-level">Transaction Isolation Level</a></li>
<li><a class="reference internal" href="#temporary-table-resource-reset-for-connection-pooling">Temporary Table / Resource Reset for Connection Pooling</a></li>
<li><a class="reference internal" href="#nullability">Nullability</a></li>
<li><a class="reference internal" href="#date-time-handling">Date / Time Handling</a></li>
<li><a class="reference internal" href="#large-text-binary-type-deprecation">Large Text/Binary Type Deprecation</a></li>
<li><a class="reference internal" href="#multipart-schema-names">Multipart Schema Names</a></li>
<li><a class="reference internal" href="#legacy-schema-mode">Legacy Schema Mode</a></li>
<li><a class="reference internal" href="#clustered-index-support">Clustered Index Support</a></li>
<li><a class="reference internal" href="#columnstore-index-support">Columnstore Index Support</a></li>
<li><a class="reference internal" href="#mssql-specific-index-options">MSSQL-Specific Index Options</a><ul>
<li><a class="reference internal" href="#include">INCLUDE</a></li>
<li><a class="reference internal" href="#filtered-indexes">Filtered Indexes</a></li>
<li><a class="reference internal" href="#index-ordering">Index ordering</a></li>
</ul>
</li>
<li><a class="reference internal" href="#compatibility-levels">Compatibility Levels</a></li>
<li><a class="reference internal" href="#triggers">Triggers</a></li>
<li><a class="reference internal" href="#rowcount-support-orm-versioning">Rowcount Support / ORM Versioning</a></li>
<li><a class="reference internal" href="#enabling-snapshot-isolation">Enabling Snapshot Isolation</a></li>
<li><a class="reference internal" href="#sql-server-sql-constructs">SQL Server SQL Constructs</a><ul>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.try_cast"><code class="docutils literal notranslate"><span class="pre">try_cast()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sql-server-data-types">SQL Server Data Types</a><ul>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.BIT"><code class="docutils literal notranslate"><span class="pre">BIT</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.BIT.__init__"><code class="docutils literal notranslate"><span class="pre">BIT.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.DATETIME2"><code class="docutils literal notranslate"><span class="pre">DATETIME2</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.DATETIMEOFFSET"><code class="docutils literal notranslate"><span class="pre">DATETIMEOFFSET</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.DOUBLE_PRECISION"><code class="docutils literal notranslate"><span class="pre">DOUBLE_PRECISION</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.IMAGE"><code class="docutils literal notranslate"><span class="pre">IMAGE</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.IMAGE.__init__"><code class="docutils literal notranslate"><span class="pre">IMAGE.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.JSON"><code class="docutils literal notranslate"><span class="pre">JSON</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.JSON.__init__"><code class="docutils literal notranslate"><span class="pre">JSON.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.MONEY"><code class="docutils literal notranslate"><span class="pre">MONEY</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.NTEXT"><code class="docutils literal notranslate"><span class="pre">NTEXT</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.NTEXT.__init__"><code class="docutils literal notranslate"><span class="pre">NTEXT.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.REAL"><code class="docutils literal notranslate"><span class="pre">REAL</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.ROWVERSION"><code class="docutils literal notranslate"><span class="pre">ROWVERSION</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.ROWVERSION.__init__"><code class="docutils literal notranslate"><span class="pre">ROWVERSION.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.SMALLDATETIME"><code class="docutils literal notranslate"><span class="pre">SMALLDATETIME</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.SMALLDATETIME.__init__"><code class="docutils literal notranslate"><span class="pre">SMALLDATETIME.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.SMALLMONEY"><code class="docutils literal notranslate"><span class="pre">SMALLMONEY</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.SQL_VARIANT"><code class="docutils literal notranslate"><span class="pre">SQL_VARIANT</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.TIME"><code class="docutils literal notranslate"><span class="pre">TIME</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.TIMESTAMP"><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.TIMESTAMP.__init__"><code class="docutils literal notranslate"><span class="pre">TIMESTAMP.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.TINYINT"><code class="docutils literal notranslate"><span class="pre">TINYINT</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER"><code class="docutils literal notranslate"><span class="pre">UNIQUEIDENTIFIER</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER.__init__"><code class="docutils literal notranslate"><span class="pre">UNIQUEIDENTIFIER.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.XML"><code class="docutils literal notranslate"><span class="pre">XML</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.dialects.mssql.XML.__init__"><code class="docutils literal notranslate"><span class="pre">XML.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-sqlalchemy.dialects.mssql.pyodbc">PyODBC</a><ul>
<li><a class="reference internal" href="#dialect-mssql-pyodbc-url">DBAPI</a></li>
<li><a class="reference internal" href="#dialect-mssql-pyodbc-connect">Connecting</a></li>
<li><a class="reference internal" href="#connecting-to-pyodbc">Connecting to PyODBC</a><ul>
<li><a class="reference internal" href="#dsn-connections">DSN Connections</a></li>
<li><a class="reference internal" href="#hostname-connections">Hostname Connections</a></li>
<li><a class="reference internal" href="#pass-through-exact-pyodbc-string">Pass through exact Pyodbc string</a></li>
<li><a class="reference internal" href="#connecting-to-databases-with-access-tokens">Connecting to databases with access tokens</a></li>
<li><a class="reference internal" href="#avoiding-transaction-related-exceptions-on-azure-synapse-analytics">Avoiding transaction-related exceptions on Azure Synapse Analytics</a></li>
<li><a class="reference internal" href="#enable-autocommit-for-azure-sql-data-warehouse-dw-connections">Enable autocommit for Azure SQL Data Warehouse (DW) connections</a></li>
<li><a class="reference internal" href="#avoiding-sending-large-string-parameters-as-text-ntext">Avoiding sending large string parameters as TEXT/NTEXT</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyodbc-pooling-connection-close-behavior">Pyodbc Pooling / connection close behavior</a></li>
<li><a class="reference internal" href="#driver-unicode-support">Driver / Unicode Support</a></li>
<li><a class="reference internal" href="#rowcount-support">Rowcount Support</a></li>
<li><a class="reference internal" href="#fast-executemany-mode">Fast Executemany Mode</a></li>
<li><a class="reference internal" href="#setinputsizes-support">Setinputsizes Support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-sqlalchemy.dialects.mssql.pymssql">pymssql</a><ul>
<li><a class="reference internal" href="#dialect-mssql-pymssql-connect">Connecting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-sqlalchemy.dialects.mssql.aioodbc">aioodbc</a><ul>
<li><a class="reference internal" href="#dialect-mssql-aioodbc-url">DBAPI</a></li>
<li><a class="reference internal" href="#dialect-mssql-aioodbc-connect">Connecting</a></li>
</ul>
</li>
</ul>
</li>
</ul>


            </ul>

        </div>



    <div id="docs-body" role="main" class="withsidebar dialects-mssql" >
        
<section id="module-sqlalchemy.dialects.mssql.base">
<span id="microsoft-sql-server"></span><span id="mssql-toplevel"></span><h1>Microsoft SQL Server<a class="headerlink" href="#module-sqlalchemy.dialects.mssql.base" title="Link to this heading">¶</a></h1>
<section id="dialect-mssql">
<p>Support for the Microsoft SQL Server database.</p>
<p>The following table summarizes current support levels for database release versions.</p>
<p><table class="docutils align-default" id="id3">
<caption><span class="caption-text"><strong>Supported Microsoft SQL Server versions</strong></span><a class="headerlink" href="#id3" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Support type</p></th>
<th class="head"><p>Versions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#term-Fully-tested-in-CI"><span class="xref std std-term">Fully tested in CI</span></a></p></td>
<td><p>2017</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#term-Normal-support"><span class="xref std std-term">Normal support</span></a></p></td>
<td><p>2012+</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#term-Best-effort"><span class="xref std std-term">Best effort</span></a></p></td>
<td><p>2005+</p></td>
</tr>
</tbody>
</table>
</p>
<h2>DBAPI Support<a class="headerlink" href="#dialect-mssql" title="Link to this heading">¶</a></h2>
<p>The following dialect/DBAPI options are available.  Please refer to individual DBAPI sections for connect information.<ul class="simple">
<li><p><a class="reference external" href="#module-sqlalchemy.dialects.mssql.pyodbc">PyODBC</a></p></li>
<li><p><a class="reference external" href="#module-sqlalchemy.dialects.mssql.pymssql">pymssql</a></p></li>
<li><p><a class="reference external" href="#module-sqlalchemy.dialects.mssql.aioodbc">aioodbc</a></p></li>
</ul>
</p>
</section>
<section id="external-dialects">
<span id="mssql-external-dialects"></span><h2>External Dialects<a class="headerlink" href="#external-dialects" title="Link to this heading">¶</a></h2>
<p>In addition to the above DBAPI layers with native SQLAlchemy support, there
are third-party dialects for other DBAPI layers that are compatible
with SQL Server. See the “External Dialects” list on the
<a class="reference internal" href="index.html"><span class="std std-ref">Dialects</span></a> page.</p>
</section>
<section id="auto-increment-behavior-identity-columns">
<span id="mssql-identity"></span><h2>Auto Increment Behavior / IDENTITY Columns<a class="headerlink" href="#auto-increment-behavior-identity-columns" title="Link to this heading">¶</a></h2>
<p>SQL Server provides so-called “auto incrementing” behavior using the
<code class="docutils literal notranslate"><span class="pre">IDENTITY</span></code> construct, which can be placed on any single integer column in a
table. SQLAlchemy considers <code class="docutils literal notranslate"><span class="pre">IDENTITY</span></code> within its default “autoincrement”
behavior for an integer primary key column, described at
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column.params.autoincrement" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.autoincrement</span></code></a>.  This means that by default,
the first integer primary key column in a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> will be
considered to be the identity column - unless it is associated with a
<a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> - and will generate DDL as such:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">MetaData</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Integer</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">))</span>
<span class="n">m</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span></pre></div>
</div>
<p>The above example will generate DDL as:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">IDENTITY</span><span class="p">,</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">)</span></pre></div>
</div>
<p>For the case where this default generation of <code class="docutils literal notranslate"><span class="pre">IDENTITY</span></code> is not desired,
specify <code class="docutils literal notranslate"><span class="pre">False</span></code> for the <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column.params.autoincrement" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.autoincrement</span></code></a> flag,
on the first integer primary key column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">autoincrement</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">))</span>
<span class="n">m</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span></pre></div>
</div>
<p>To add the <code class="docutils literal notranslate"><span class="pre">IDENTITY</span></code> keyword to a non-primary key column, specify
<code class="docutils literal notranslate"><span class="pre">True</span></code> for the <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column.params.autoincrement" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.autoincrement</span></code></a> flag on the desired
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> object, and ensure that
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column.params.autoincrement" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.autoincrement</span></code></a>
is set to <code class="docutils literal notranslate"><span class="pre">False</span></code> on any integer primary key column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">autoincrement</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">autoincrement</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">m</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span></pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4: </span>Added <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Identity" title="sqlalchemy.schema.Identity"><code class="xref py py-class docutils literal notranslate"><span class="pre">Identity</span></code></a> construct
in a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> to specify the start and increment
parameters of an IDENTITY. These replace
the use of the <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> object in order to specify these values.</p>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.4: </span>The <code class="docutils literal notranslate"><span class="pre">mssql_identity_start</span></code> and <code class="docutils literal notranslate"><span class="pre">mssql_identity_increment</span></code> parameters
to <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> are deprecated and should we replaced by
an <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Identity" title="sqlalchemy.schema.Identity"><code class="xref py py-class docutils literal notranslate"><span class="pre">Identity</span></code></a> object. Specifying both ways of configuring
an IDENTITY will result in a compile error.
These options are also no longer returned as part of the
<code class="docutils literal notranslate"><span class="pre">dialect_options</span></code> key in <a class="reference internal" href="../core/reflection.html#sqlalchemy.engine.reflection.Inspector.get_columns" title="sqlalchemy.engine.reflection.Inspector.get_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Inspector.get_columns()</span></code></a>.
Use the information in the <code class="docutils literal notranslate"><span class="pre">identity</span></code> key instead.</p>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.3: </span>The use of <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> to specify IDENTITY characteristics is
deprecated and will be removed in a future release.   Please use
the <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Identity" title="sqlalchemy.schema.Identity"><code class="xref py py-class docutils literal notranslate"><span class="pre">Identity</span></code></a> object parameters
<a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Identity.params.start" title="sqlalchemy.schema.Identity"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Identity.start</span></code></a> and
<a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Identity.params.increment" title="sqlalchemy.schema.Identity"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Identity.increment</span></code></a>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4: </span>Removed the ability to use a <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>
object to modify IDENTITY characteristics. <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> objects
now only manipulate true T-SQL SEQUENCE types.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There can only be one IDENTITY column on the table.  When using
<code class="docutils literal notranslate"><span class="pre">autoincrement=True</span></code> to enable the IDENTITY keyword, SQLAlchemy does not
guard against multiple columns specifying the option simultaneously.  The
SQL Server database will instead reject the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> statement.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An INSERT statement which attempts to provide a value for a column that is
marked with IDENTITY will be rejected by SQL Server.   In order for the
value to be accepted, a session-level option “SET IDENTITY_INSERT” must be
enabled.   The SQLAlchemy SQL Server dialect will perform this operation
automatically when using a core <a class="reference internal" href="../core/dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal notranslate"><span class="pre">Insert</span></code></a>
construct; if the
execution specifies a value for the IDENTITY column, the “IDENTITY_INSERT”
option will be enabled for the span of that statement’s invocation.However,
this scenario is not high performing and should not be relied upon for
normal use.   If a table doesn’t actually require IDENTITY behavior in its
integer primary key column, the keyword should be disabled when creating
the table by ensuring that <code class="docutils literal notranslate"><span class="pre">autoincrement=False</span></code> is set.</p>
</div>
<section id="controlling-start-and-increment">
<h3>Controlling “Start” and “Increment”<a class="headerlink" href="#controlling-start-and-increment" title="Link to this heading">¶</a></h3>
<p>Specific control over the “start” and “increment” values for
the <code class="docutils literal notranslate"><span class="pre">IDENTITY</span></code> generator are provided using the
<a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Identity.params.start" title="sqlalchemy.schema.Identity"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Identity.start</span></code></a> and <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Identity.params.increment" title="sqlalchemy.schema.Identity"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Identity.increment</span></code></a>
parameters passed to the <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Identity" title="sqlalchemy.schema.Identity"><code class="xref py py-class docutils literal notranslate"><span class="pre">Identity</span></code></a> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Identity</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
    <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span>
        <span class="s1">&#39;id&#39;</span><span class="p">,</span>
        <span class="n">Integer</span><span class="p">,</span>
        <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">Identity</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">increment</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="p">)</span></pre></div>
</div>
<p>The CREATE TABLE for the above <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> object would be:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="n">id</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">IDENTITY</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">  </span><span class="p">)</span></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Identity" title="sqlalchemy.schema.Identity"><code class="xref py py-class docutils literal notranslate"><span class="pre">Identity</span></code></a> object supports many other parameter in
addition to <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">increment</span></code>. These are not supported by
SQL Server and will be ignored when generating the CREATE TABLE ddl.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.3.19: </span>The <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Identity" title="sqlalchemy.schema.Identity"><code class="xref py py-class docutils literal notranslate"><span class="pre">Identity</span></code></a> object is
now used to affect the
<code class="docutils literal notranslate"><span class="pre">IDENTITY</span></code> generator for a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> under  SQL Server.
Previously, the <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> object was used.  As SQL Server now
supports real sequences as a separate construct, <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> will be
functional in the normal way starting from SQLAlchemy version 1.4.</p>
</div>
</section>
<section id="using-identity-with-non-integer-numeric-types">
<h3>Using IDENTITY with Non-Integer numeric types<a class="headerlink" href="#using-identity-with-non-integer-numeric-types" title="Link to this heading">¶</a></h3>
<p>SQL Server also allows <code class="docutils literal notranslate"><span class="pre">IDENTITY</span></code> to be used with <code class="docutils literal notranslate"><span class="pre">NUMERIC</span></code> columns.  To
implement this pattern smoothly in SQLAlchemy, the primary datatype of the
column should remain as <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, however the underlying implementation
type deployed to the SQL Server database can be specified as <code class="docutils literal notranslate"><span class="pre">Numeric</span></code> using
<a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine.with_variant" title="sqlalchemy.types.TypeEngine.with_variant"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TypeEngine.with_variant()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Column</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Integer</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Numeric</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">String</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.ext.declarative</span> <span class="kn">import</span> <span class="n">declarative_base</span>

<span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">TestTable</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
    <span class="n">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">Integer</span><span class="p">()</span><span class="o">.</span><span class="n">with_variant</span><span class="p">(</span><span class="n">Numeric</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;mssql&quot;</span><span class="p">),</span>
        <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">autoincrement</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">)</span></pre><div class="code-non-annotations-key"></div></div>
</div>
<p>In the above example, <code class="docutils literal notranslate"><span class="pre">Integer().with_variant()</span></code> provides clear usage
information that accurately describes the intent of the code. The general
restriction that <code class="docutils literal notranslate"><span class="pre">autoincrement</span></code> only applies to <code class="docutils literal notranslate"><span class="pre">Integer</span></code> is established
at the metadata level and not at the per-dialect level.</p>
<p>When using the above pattern, the primary key identifier that comes back from
the insertion of a row, which is also the value that would be assigned to an
ORM object such as <code class="docutils literal notranslate"><span class="pre">TestTable</span></code> above, will be an instance of <code class="docutils literal notranslate"><span class="pre">Decimal()</span></code>
and not <code class="docutils literal notranslate"><span class="pre">int</span></code> when using SQL Server. The numeric return type of the
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Numeric" title="sqlalchemy.types.Numeric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Numeric</span></code></a> type can be changed to return floats by passing False
to <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Numeric.params.asdecimal" title="sqlalchemy.types.Numeric"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Numeric.asdecimal</span></code></a>. To normalize the return type of the
above <code class="docutils literal notranslate"><span class="pre">Numeric(10,</span> <span class="pre">0)</span></code> to return Python ints (which also support “long”
integer values in Python 3), use <a class="reference internal" href="../core/custom_types.html#sqlalchemy.types.TypeDecorator" title="sqlalchemy.types.TypeDecorator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeDecorator</span></code></a> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">TypeDecorator</span>

<span class="k">class</span> <span class="nc">NumericAsInteger</span><span class="p">(</span><span class="n">TypeDecorator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;normalize floating point return values into ints&#39;&#39;&#39;</span>

    <span class="n">impl</span> <span class="o">=</span> <span class="n">Numeric</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">asdecimal</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">cache_ok</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">process_result_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">dialect</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

<span class="k">class</span> <span class="nc">TestTable</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
    <span class="n">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">Integer</span><span class="p">()</span><span class="o">.</span><span class="n">with_variant</span><span class="p">(</span><span class="n">NumericAsInteger</span><span class="p">,</span> <span class="s2">&quot;mssql&quot;</span><span class="p">),</span>
        <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">autoincrement</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">)</span></pre><div class="code-non-annotations-key"></div></div>
</div>
</section>
<section id="insert-behavior">
<span id="mssql-insert-behavior"></span><h3>INSERT behavior<a class="headerlink" href="#insert-behavior" title="Link to this heading">¶</a></h3>
<p>Handling of the <code class="docutils literal notranslate"><span class="pre">IDENTITY</span></code> column at INSERT time involves two key
techniques. The most common is being able to fetch the “last inserted value”
for a given <code class="docutils literal notranslate"><span class="pre">IDENTITY</span></code> column, a process which SQLAlchemy performs
implicitly in many cases, most importantly within the ORM.</p>
<p>The process for fetching this value has several variants:</p>
<ul>
<li><p>In the vast majority of cases, RETURNING is used in conjunction with INSERT
statements on SQL Server in order to get newly generated primary key values:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">OUTPUT</span><span class="w"> </span><span class="n">inserted</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="p">)</span></pre></div>
</div>
<p>As of SQLAlchemy 2.0, the <a class="reference internal" href="../core/connections.html#engine-insertmanyvalues"><span class="std std-ref">“Insert Many Values” Behavior for INSERT statements</span></a> feature is also
used by default to optimize many-row INSERT statements; for SQL Server
the feature takes place for both RETURNING and-non RETURNING
INSERT statements.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0.10: </span>The <a class="reference internal" href="../core/connections.html#engine-insertmanyvalues"><span class="std std-ref">“Insert Many Values” Behavior for INSERT statements</span></a> feature for
SQL Server was temporarily disabled for SQLAlchemy version 2.0.9 due to
issues with row ordering. As of 2.0.10 the feature is re-enabled, with
special case handling for the unit of work’s requirement for RETURNING to
be ordered.</p>
</div>
</li>
<li><p>When RETURNING is not available or has been disabled via
<code class="docutils literal notranslate"><span class="pre">implicit_returning=False</span></code>, either the <code class="docutils literal notranslate"><span class="pre">scope_identity()</span></code> function or
the <code class="docutils literal notranslate"><span class="pre">&#64;&#64;identity</span></code> variable is used; behavior varies by backend:</p>
<ul>
<li><p>when using PyODBC, the phrase <code class="docutils literal notranslate"><span class="pre">;</span> <span class="pre">select</span> <span class="pre">scope_identity()</span></code> will be
appended to the end of the INSERT statement; a second result set will be
fetched in order to receive the value.  Given a table as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
    <span class="s1">&#39;t&#39;</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">),</span>
    <span class="n">implicit_returning</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span></pre></div>
</div>
<p>an INSERT will look like:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="p">);</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">scope_identity</span><span class="p">()</span></pre></div>
</div>
</li>
<li><p>Other dialects such as pymssql will call upon
<code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">scope_identity()</span> <span class="pre">AS</span> <span class="pre">lastrowid</span></code> subsequent to an INSERT
statement. If the flag <code class="docutils literal notranslate"><span class="pre">use_scope_identity=False</span></code> is passed to
<a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a>,
the statement <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">&#64;&#64;identity</span> <span class="pre">AS</span> <span class="pre">lastrowid</span></code>
is used instead.</p></li>
</ul>
</li>
</ul>
<p>A table that contains an <code class="docutils literal notranslate"><span class="pre">IDENTITY</span></code> column will prohibit an INSERT statement
that refers to the identity column explicitly.  The SQLAlchemy dialect will
detect when an INSERT construct, created using a core
<a class="reference internal" href="../core/dml.html#sqlalchemy.sql.expression.insert" title="sqlalchemy.sql.expression.insert"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert()</span></code></a>
construct (not a plain string SQL), refers to the identity column, and
in this case will emit <code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">IDENTITY_INSERT</span> <span class="pre">ON</span></code> prior to the insert
statement proceeding, and <code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">IDENTITY_INSERT</span> <span class="pre">OFF</span></code> subsequent to the
execution.  Given this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">))</span>
<span class="n">m</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">insert</span><span class="p">(),</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span></pre></div>
</div>
<p>The above column will be created with IDENTITY, however the INSERT statement
we emit is specifying explicit values.  In the echo output we can see
how SQLAlchemy handles this:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">IDENTITY</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">COMMIT</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">ON</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="p">)</span>
<span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">OFF</span>
<span class="k">COMMIT</span></pre></div>
</div>
<p>This is an auxiliary use case suitable for testing and bulk insert scenarios.</p>
</section>
</section>
<section id="sequence-support">
<h2>SEQUENCE support<a class="headerlink" href="#sequence-support" title="Link to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> object creates “real” sequences, i.e.,
<code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">SEQUENCE</span></code>:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.schema</span> <span class="kn">import</span> <span class="n">CreateSequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects</span> <span class="kn">import</span> <span class="n">mssql</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">CreateSequence</span><span class="p">(</span><span class="n">Sequence</span><span class="p">(</span><span class="s2">&quot;my_seq&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">dialect</span><span class="o">=</span><span class="n">mssql</span><span class="o">.</span><span class="n">dialect</span><span class="p">()))</span>
<div class='show_sql_print'><span class="k">CREATE</span><span class="w"> </span><span class="n">SEQUENCE</span><span class="w"> </span><span class="n">my_seq</span><span class="w"> </span><span class="k">START</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="mi">1</span>
</div></pre></div>
</div>
<p>For integer primary key generation, SQL Server’s <code class="docutils literal notranslate"><span class="pre">IDENTITY</span></code> construct should
generally be preferred vs. sequence.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The default start value for T-SQL is <code class="docutils literal notranslate"><span class="pre">-2**63</span></code> instead of 1 as
in most other SQL databases. Users should explicitly set the
<a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence.params.start" title="sqlalchemy.schema.Sequence"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Sequence.start</span></code></a> to 1 if that’s the expected default:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seq</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="s2">&quot;my_sequence&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></pre></div>
</div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.4: </span>added SQL Server support for <a class="reference internal" href="../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0: </span>The SQL Server dialect will no longer implicitly
render “START WITH 1” for <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">SEQUENCE</span></code>, which was the behavior
first implemented in version 1.4.</p>
</div>
</section>
<section id="max-on-varchar-nvarchar">
<h2>MAX on VARCHAR / NVARCHAR<a class="headerlink" href="#max-on-varchar-nvarchar" title="Link to this heading">¶</a></h2>
<p>SQL Server supports the special string “MAX” within the
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.VARCHAR" title="sqlalchemy.types.VARCHAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">VARCHAR</span></code></a> and <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.NVARCHAR" title="sqlalchemy.types.NVARCHAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">NVARCHAR</span></code></a> datatypes,
to indicate “maximum length possible”.   The dialect currently handles this as
a length of “None” in the base type, rather than supplying a
dialect-specific version of these types, so that a base type
specified such as <code class="docutils literal notranslate"><span class="pre">VARCHAR(None)</span></code> can assume “unlengthed” behavior on
more than one backend without using dialect-specific types.</p>
<p>To build a SQL Server VARCHAR or NVARCHAR with MAX length, use None:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
    <span class="s1">&#39;my_table&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;my_data&#39;</span><span class="p">,</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="kc">None</span><span class="p">)),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;my_n_data&#39;</span><span class="p">,</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
<span class="p">)</span></pre></div>
</div>
</section>
<section id="collation-support">
<h2>Collation Support<a class="headerlink" href="#collation-support" title="Link to this heading">¶</a></h2>
<p>Character collations are supported by the base string types,
specified by the string argument “collation”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">VARCHAR</span>
<span class="n">Column</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">collation</span><span class="o">=</span><span class="s1">&#39;Latin1_General_CI_AS&#39;</span><span class="p">))</span></pre></div>
</div>
<p>When such a column is associated with a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>, the
CREATE TABLE statement for this column will yield:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">login</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="n">COLLATE</span> <span class="n">Latin1_General_CI_AS</span> <span class="n">NULL</span></pre></div>
</div>
</section>
<section id="limit-offset-support">
<h2>LIMIT/OFFSET Support<a class="headerlink" href="#limit-offset-support" title="Link to this heading">¶</a></h2>
<p>MSSQL has added support for LIMIT / OFFSET as of SQL Server 2012, via the
“OFFSET n ROWS” and “FETCH NEXT n ROWS” clauses.  SQLAlchemy supports these
syntaxes automatically if SQL Server 2012 or greater is detected.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4: </span>support added for SQL Server “OFFSET n ROWS” and
“FETCH NEXT n ROWS” syntax.</p>
</div>
<p>For statements that specify only LIMIT and no OFFSET, all versions of SQL
Server support the TOP keyword.   This syntax is used for all SQL Server
versions when no OFFSET clause is present.  A statement such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span><span class="p">(</span><span class="n">some_table</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span></pre></div>
</div>
<p>will render similarly to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">TOP</span> <span class="mi">5</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="o">..</span> <span class="n">FROM</span> <span class="n">table</span></pre></div>
</div>
<p>For versions of SQL Server prior to SQL Server 2012, a statement that uses
LIMIT and OFFSET, or just OFFSET alone, will be rendered using the
<code class="docutils literal notranslate"><span class="pre">ROW_NUMBER()</span></code> window function.   A statement such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span><span class="p">(</span><span class="n">some_table</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">some_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">col3</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></pre></div>
</div>
<p>will render similarly to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">anon_1</span><span class="o">.</span><span class="n">col1</span><span class="p">,</span> <span class="n">anon_1</span><span class="o">.</span><span class="n">col2</span> <span class="n">FROM</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span>
<span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span><span class="n">ORDER</span> <span class="n">BY</span> <span class="n">col3</span><span class="p">)</span> <span class="n">AS</span>
<span class="n">mssql_rn</span> <span class="n">FROM</span> <span class="n">table</span> <span class="n">WHERE</span> <span class="n">t</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">:</span><span class="n">x_1</span><span class="p">)</span> <span class="n">AS</span>
<span class="n">anon_1</span> <span class="n">WHERE</span> <span class="n">mssql_rn</span> <span class="o">&gt;</span> <span class="p">:</span><span class="n">param_1</span> <span class="n">AND</span> <span class="n">mssql_rn</span> <span class="o">&lt;=</span> <span class="p">:</span><span class="n">param_2</span> <span class="o">+</span> <span class="p">:</span><span class="n">param_1</span></pre></div>
</div>
<p>Note that when using LIMIT and/or OFFSET, whether using the older
or newer SQL Server syntaxes, the statement must have an ORDER BY as well,
else a <a class="reference internal" href="../core/exceptions.html#sqlalchemy.exc.CompileError" title="sqlalchemy.exc.CompileError"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompileError</span></code></a> is raised.</p>
</section>
<section id="ddl-comment-support">
<span id="mssql-comment-support"></span><h2>DDL Comment Support<a class="headerlink" href="#ddl-comment-support" title="Link to this heading">¶</a></h2>
<p>Comment support, which includes DDL rendering for attributes such as
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table.params.comment" title="sqlalchemy.schema.Table"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Table.comment</span></code></a> and <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column.params.comment" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.comment</span></code></a>, as
well as the ability to reflect these comments, is supported assuming a
supported version of SQL Server is in use. If a non-supported version such as
Azure Synapse is detected at first-connect time (based on the presence
of the <code class="docutils literal notranslate"><span class="pre">fn_listextendedproperty</span></code> SQL function), comment support including
rendering and table-comment reflection is disabled, as both features rely upon
SQL Server stored procedures and functions that are not available on all
backend types.</p>
<p>To force comment support to be on or off, bypassing autodetection, set the
parameter <code class="docutils literal notranslate"><span class="pre">supports_comments</span></code> within <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mssql+pyodbc://u:p@dsn&quot;</span><span class="p">,</span> <span class="n">supports_comments</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.0: </span>Added support for table and column comments for
the SQL Server dialect, including DDL generation and reflection.</p>
</div>
</section>
<section id="transaction-isolation-level">
<span id="mssql-isolation-level"></span><h2>Transaction Isolation Level<a class="headerlink" href="#transaction-isolation-level" title="Link to this heading">¶</a></h2>
<p>All SQL Server dialects support setting of transaction isolation level
both via a dialect-specific parameter
<a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine.params.isolation_level" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.isolation_level</span></code></a>
accepted by <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a>,
as well as the <a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Connection.execution_options.params.isolation_level" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Connection.execution_options.isolation_level</span></code></a>
argument as passed to
<a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Connection.execution_options" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.execution_options()</span></code></a>.
This feature works by issuing the
command <code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">TRANSACTION</span> <span class="pre">ISOLATION</span> <span class="pre">LEVEL</span> <span class="pre">&lt;level&gt;</span></code> for
each new connection.</p>
<p>To set isolation level using <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;mssql+pyodbc://scott:tiger@ms_2008&quot;</span><span class="p">,</span>
    <span class="n">isolation_level</span><span class="o">=</span><span class="s2">&quot;REPEATABLE READ&quot;</span>
<span class="p">)</span></pre></div>
</div>
<p>To set using per-connection execution options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span>
    <span class="n">isolation_level</span><span class="o">=</span><span class="s2">&quot;READ COMMITTED&quot;</span>
<span class="p">)</span></pre></div>
</div>
<p>Valid values for <code class="docutils literal notranslate"><span class="pre">isolation_level</span></code> include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">AUTOCOMMIT</span></code> - pyodbc / pymssql-specific</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">READ</span> <span class="pre">COMMITTED</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">READ</span> <span class="pre">UNCOMMITTED</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">REPEATABLE</span> <span class="pre">READ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SERIALIZABLE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SNAPSHOT</span></code> - specific to SQL Server</p></li>
</ul>
<p>There are also more options for isolation level configurations, such as
“sub-engine” objects linked to a main <a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> which each apply
different isolation level settings.  See the discussion at
<a class="reference internal" href="../core/connections.html#dbapi-autocommit"><span class="std std-ref">Setting Transaction Isolation Levels including DBAPI Autocommit</span></a> for background.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../core/connections.html#dbapi-autocommit"><span class="std std-ref">Setting Transaction Isolation Levels including DBAPI Autocommit</span></a></p>
</div>
</section>
<section id="temporary-table-resource-reset-for-connection-pooling">
<span id="mssql-reset-on-return"></span><h2>Temporary Table / Resource Reset for Connection Pooling<a class="headerlink" href="#temporary-table-resource-reset-for-connection-pooling" title="Link to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../core/pooling.html#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a> connection pool implementation used
by the SQLAlchemy <a class="reference internal" href="../core/connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> object includes
<a class="reference internal" href="../core/pooling.html#pool-reset-on-return"><span class="std std-ref">reset on return</span></a> behavior that will invoke
the DBAPI <code class="docutils literal notranslate"><span class="pre">.rollback()</span></code> method when connections are returned to the pool.
While this rollback will clear out the immediate state used by the previous
transaction, it does not cover a wider range of session-level state, including
temporary tables as well as other server state such as prepared statement
handles and statement caches.   An undocumented SQL Server procedure known
as <code class="docutils literal notranslate"><span class="pre">sp_reset_connection</span></code> is known to be a workaround for this issue which
will reset most of the session state that builds up on a connection, including
temporary tables.</p>
<p>To install <code class="docutils literal notranslate"><span class="pre">sp_reset_connection</span></code> as the means of performing reset-on-return,
the <a class="reference internal" href="../core/events.html#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> event hook may be used, as demonstrated in the
example below. The <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine.params.pool_reset_on_return" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.pool_reset_on_return</span></code></a> parameter
is set to <code class="docutils literal notranslate"><span class="pre">None</span></code> so that the custom scheme can replace the default behavior
completely.   The custom hook implementation calls <code class="docutils literal notranslate"><span class="pre">.rollback()</span></code> in any case,
as it’s usually important that the DBAPI’s own tracking of commit/rollback
will remain consistent with the state of the transaction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="n">mssql_engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;mssql+pyodbc://scott:tiger^5HHH@mssql2017:1433/test?driver=ODBC+Driver+17+for+SQL+Server&quot;</span><span class="p">,</span>

    <span class="c1"># disable default reset-on-return scheme</span>
    <span class="n">pool_reset_on_return</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">mssql_engine</span><span class="p">,</span> <span class="s2">&quot;reset&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_reset_mssql</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">,</span> <span class="n">reset_state</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">reset_state</span><span class="o">.</span><span class="n">terminate_only</span><span class="p">:</span>
        <span class="n">dbapi_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;{call sys.sp_reset_connection}&quot;</span><span class="p">)</span>

    <span class="c1"># so that the DBAPI itself knows that the connection has been</span>
    <span class="c1"># reset</span>
    <span class="n">dbapi_connection</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span></pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0.0b3: </span>Added additional state arguments to
the <a class="reference internal" href="../core/events.html#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> event and additionally ensured the event
is invoked for all “reset” occurrences, so that it’s appropriate
as a place for custom “reset” handlers.   Previous schemes which
use the <a class="reference internal" href="../core/events.html#sqlalchemy.events.PoolEvents.checkin" title="sqlalchemy.events.PoolEvents.checkin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.checkin()</span></code></a> handler remain usable as well.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../core/pooling.html#pool-reset-on-return"><span class="std std-ref">Reset On Return</span></a> - in the <a class="reference internal" href="../core/pooling.html"><span class="std std-ref">Connection Pooling</span></a> documentation</p>
</div>
</section>
<section id="nullability">
<h2>Nullability<a class="headerlink" href="#nullability" title="Link to this heading">¶</a></h2>
<p>MSSQL has support for three levels of column nullability. The default
nullability allows nulls and is explicit in the CREATE TABLE
construct:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="n">NULL</span></pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">nullable=None</span></code> is specified then no specification is made. In
other words the database’s configured default is used. This will
render:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span></pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">nullable</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> then the column will be
<code class="docutils literal notranslate"><span class="pre">NULL</span></code> or <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">NULL</span></code> respectively.</p>
</section>
<section id="date-time-handling">
<h2>Date / Time Handling<a class="headerlink" href="#date-time-handling" title="Link to this heading">¶</a></h2>
<p>DATE and TIME are supported.   Bind parameters are converted
to datetime.datetime() objects as required by most MSSQL drivers,
and results are processed from strings if needed.
The DATE and TIME types are not available for MSSQL 2005 and
previous - if a server version below 2008 is detected, DDL
for these types will be issued as DATETIME.</p>
</section>
<section id="large-text-binary-type-deprecation">
<span id="mssql-large-type-deprecation"></span><h2>Large Text/Binary Type Deprecation<a class="headerlink" href="#large-text-binary-type-deprecation" title="Link to this heading">¶</a></h2>
<p>Per
<a class="reference external" href="https://technet.microsoft.com/en-us/library/ms187993.aspx">SQL Server 2012/2014 Documentation</a>,
the <code class="docutils literal notranslate"><span class="pre">NTEXT</span></code>, <code class="docutils literal notranslate"><span class="pre">TEXT</span></code> and <code class="docutils literal notranslate"><span class="pre">IMAGE</span></code> datatypes are to be removed from SQL
Server in a future release.   SQLAlchemy normally relates these types to the
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnicodeText</span></code></a>, <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.TextClause" title="sqlalchemy.sql.expression.TextClause"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextClause</span></code></a> and
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.LargeBinary" title="sqlalchemy.types.LargeBinary"><code class="xref py py-class docutils literal notranslate"><span class="pre">LargeBinary</span></code></a> datatypes.</p>
<p>In order to accommodate this change, a new flag <code class="docutils literal notranslate"><span class="pre">deprecate_large_types</span></code>
is added to the dialect, which will be automatically set based on detection
of the server version in use, if not otherwise set by the user.  The
behavior of this flag is as follows:</p>
<ul>
<li><p>When this flag is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnicodeText</span></code></a>,
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.TextClause" title="sqlalchemy.sql.expression.TextClause"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextClause</span></code></a> and
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.LargeBinary" title="sqlalchemy.types.LargeBinary"><code class="xref py py-class docutils literal notranslate"><span class="pre">LargeBinary</span></code></a> datatypes, when used to render DDL, will render the
types <code class="docutils literal notranslate"><span class="pre">NVARCHAR(max)</span></code>, <code class="docutils literal notranslate"><span class="pre">VARCHAR(max)</span></code>, and <code class="docutils literal notranslate"><span class="pre">VARBINARY(max)</span></code>,
respectively.  This is a new behavior as of the addition of this flag.</p></li>
<li><p>When this flag is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnicodeText</span></code></a>,
<a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.TextClause" title="sqlalchemy.sql.expression.TextClause"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextClause</span></code></a> and
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.LargeBinary" title="sqlalchemy.types.LargeBinary"><code class="xref py py-class docutils literal notranslate"><span class="pre">LargeBinary</span></code></a> datatypes, when used to render DDL, will render the
types <code class="docutils literal notranslate"><span class="pre">NTEXT</span></code>, <code class="docutils literal notranslate"><span class="pre">TEXT</span></code>, and <code class="docutils literal notranslate"><span class="pre">IMAGE</span></code>,
respectively.  This is the long-standing behavior of these types.</p></li>
<li><p>The flag begins with the value <code class="docutils literal notranslate"><span class="pre">None</span></code>, before a database connection is
established.   If the dialect is used to render DDL without the flag being
set, it is interpreted the same as <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p>On first connection, the dialect detects if SQL Server version 2012 or
greater is in use; if the flag is still at <code class="docutils literal notranslate"><span class="pre">None</span></code>, it sets it to <code class="docutils literal notranslate"><span class="pre">True</span></code>
or <code class="docutils literal notranslate"><span class="pre">False</span></code> based on whether 2012 or greater is detected.</p></li>
<li><p>The flag can be set to either <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> when the dialect
is created, typically via <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eng</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mssql+pymssql://user:pass@host/db&quot;</span><span class="p">,</span>
                <span class="n">deprecate_large_types</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
</li>
<li><p>Complete control over whether the “old” or “new” types are rendered is
available in all SQLAlchemy versions by using the UPPERCASE type objects
instead: <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.NVARCHAR" title="sqlalchemy.types.NVARCHAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">NVARCHAR</span></code></a>, <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.VARCHAR" title="sqlalchemy.types.VARCHAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">VARCHAR</span></code></a>,
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.VARBINARY" title="sqlalchemy.types.VARBINARY"><code class="xref py py-class docutils literal notranslate"><span class="pre">VARBINARY</span></code></a>, <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.TEXT" title="sqlalchemy.types.TEXT"><code class="xref py py-class docutils literal notranslate"><span class="pre">TEXT</span></code></a>, <a class="reference internal" href="#sqlalchemy.dialects.mssql.NTEXT" title="sqlalchemy.dialects.mssql.NTEXT"><code class="xref py py-class docutils literal notranslate"><span class="pre">NTEXT</span></code></a>,
<a class="reference internal" href="#sqlalchemy.dialects.mssql.IMAGE" title="sqlalchemy.dialects.mssql.IMAGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">IMAGE</span></code></a>
will always remain fixed and always output exactly that
type.</p></li>
</ul>
</section>
<section id="multipart-schema-names">
<span id="id1"></span><h2>Multipart Schema Names<a class="headerlink" href="#multipart-schema-names" title="Link to this heading">¶</a></h2>
<p>SQL Server schemas sometimes require multiple parts to their “schema”
qualifier, that is, including the database name and owner name as separate
tokens, such as <code class="docutils literal notranslate"><span class="pre">mydatabase.dbo.some_table</span></code>. These multipart names can be set
at once using the <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table.params.schema" title="sqlalchemy.schema.Table"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Table.schema</span></code></a> argument of
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span>
    <span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">)),</span>
    <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;mydatabase.dbo&quot;</span>
<span class="p">)</span></pre></div>
</div>
<p>When performing operations such as table or component reflection, a schema
argument that contains a dot will be split into separate
“database” and “owner”  components in order to correctly query the SQL
Server information schema tables, as these two values are stored separately.
Additionally, when rendering the schema name for DDL or SQL, the two
components will be quoted separately for case sensitive names and other
special characters.   Given an argument as below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span>
    <span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">)),</span>
    <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;MyDataBase.dbo&quot;</span>
<span class="p">)</span></pre></div>
</div>
<p>The above schema would be rendered as <code class="docutils literal notranslate"><span class="pre">[MyDataBase].dbo</span></code>, and also in
reflection, would be reflected using “dbo” as the owner and “MyDataBase”
as the database name.</p>
<p>To control how the schema name is broken into database / owner,
specify brackets (which in SQL Server are quoting characters) in the name.
Below, the “owner” will be considered as <code class="docutils literal notranslate"><span class="pre">MyDataBase.dbo</span></code> and the
“database” will be None:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span>
    <span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">)),</span>
    <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;[MyDataBase.dbo]&quot;</span>
<span class="p">)</span></pre></div>
</div>
<p>To individually specify both database and owner name with special characters
or embedded dots, use two sets of brackets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span>
    <span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">)),</span>
    <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;[MyDataBase.Period].[MyOwner.Dot]&quot;</span>
<span class="p">)</span></pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2: </span>the SQL Server dialect now treats brackets as
identifier delimiters splitting the schema into separate database
and owner tokens, to allow dots within either name itself.</p>
</div>
</section>
<section id="legacy-schema-mode">
<span id="legacy-schema-rendering"></span><h2>Legacy Schema Mode<a class="headerlink" href="#legacy-schema-mode" title="Link to this heading">¶</a></h2>
<p>Very old versions of the MSSQL dialect introduced the behavior such that a
schema-qualified table would be auto-aliased when used in a
SELECT statement; given a table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">account_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
    <span class="s1">&#39;account&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">100</span><span class="p">)),</span>
    <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;customer_schema&quot;</span>
<span class="p">)</span></pre></div>
</div>
<p>this legacy mode of rendering would assume that “customer_schema.account”
would not be accepted by all parts of the SQL statement, as illustrated
below:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eng</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mssql+pymssql://mydsn&quot;</span><span class="p">,</span> <span class="n">legacy_schema_aliasing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">account_table</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">eng</span><span class="p">))</span>
<div class='show_sql_print'><span class="k">SELECT</span><span class="w"> </span><span class="n">account_1</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">account_1</span><span class="p">.</span><span class="n">info</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">customer_schema</span><span class="p">.</span><span class="n">account</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">account_1</span>
</div></pre></div>
</div>
<p>This mode of behavior is now off by default, as it appears to have served
no purpose; however in the case that legacy applications rely upon it,
it is available using the <code class="docutils literal notranslate"><span class="pre">legacy_schema_aliasing</span></code> argument to
<a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> as illustrated above.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.4: </span>The <code class="docutils literal notranslate"><span class="pre">legacy_schema_aliasing</span></code> flag is now
deprecated and will be removed in a future release.</p>
</div>
</section>
<section id="clustered-index-support">
<span id="mssql-indexes"></span><h2>Clustered Index Support<a class="headerlink" href="#clustered-index-support" title="Link to this heading">¶</a></h2>
<p>The MSSQL dialect supports clustered indexes (and primary keys) via the
<code class="docutils literal notranslate"><span class="pre">mssql_clustered</span></code> option.  This option is available to <a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a>,
<a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.UniqueConstraint" title="sqlalchemy.schema.UniqueConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueConstraint</span></code></a>. and <a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.PrimaryKeyConstraint" title="sqlalchemy.schema.PrimaryKeyConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryKeyConstraint</span></code></a>.
For indexes this option can be combined with the <code class="docutils literal notranslate"><span class="pre">mssql_columnstore</span></code> one
to create a clustered columnstore index.</p>
<p>To generate a clustered index:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">(</span><span class="s2">&quot;my_index&quot;</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mssql_clustered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
<p>which renders the index as <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">CLUSTERED</span> <span class="pre">INDEX</span> <span class="pre">my_index</span> <span class="pre">ON</span> <span class="pre">table</span> <span class="pre">(x)</span></code>.</p>
<p>To generate a clustered primary key use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s1">&#39;my_table&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
      <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span>
      <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span>
      <span class="n">PrimaryKeyConstraint</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">mssql_clustered</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span></pre></div>
</div>
<p>which will render the table, for example, as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">my_table</span> <span class="p">(</span><span class="n">x</span> <span class="n">INTEGER</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">y</span> <span class="n">INTEGER</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
                       <span class="n">PRIMARY</span> <span class="n">KEY</span> <span class="n">CLUSTERED</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span></pre></div>
</div>
<p>Similarly, we can generate a clustered unique constraint using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s1">&#39;my_table&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
      <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span>
      <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span>
      <span class="n">PrimaryKeyConstraint</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span>
      <span class="n">UniqueConstraint</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">mssql_clustered</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
      <span class="p">)</span></pre></div>
</div>
<p>To explicitly request a non-clustered primary key (for example, when
a separate clustered index is desired), use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s1">&#39;my_table&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
      <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span>
      <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span>
      <span class="n">PrimaryKeyConstraint</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">mssql_clustered</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span></pre></div>
</div>
<p>which will render the table, for example, as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">my_table</span> <span class="p">(</span><span class="n">x</span> <span class="n">INTEGER</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">y</span> <span class="n">INTEGER</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
                       <span class="n">PRIMARY</span> <span class="n">KEY</span> <span class="n">NONCLUSTERED</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span></pre></div>
</div>
</section>
<section id="columnstore-index-support">
<h2>Columnstore Index Support<a class="headerlink" href="#columnstore-index-support" title="Link to this heading">¶</a></h2>
<p>The MSSQL dialect supports columnstore indexes via the <code class="docutils literal notranslate"><span class="pre">mssql_columnstore</span></code>
option.  This option is available to <a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a>. It be combined with
the <code class="docutils literal notranslate"><span class="pre">mssql_clustered</span></code> option to create a clustered columnstore index.</p>
<p>To generate a columnstore index:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">(</span><span class="s2">&quot;my_index&quot;</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mssql_columnstore</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
<p>which renders the index as <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">COLUMNSTORE</span> <span class="pre">INDEX</span> <span class="pre">my_index</span> <span class="pre">ON</span> <span class="pre">table</span> <span class="pre">(x)</span></code>.</p>
<p>To generate a clustered columnstore index provide no columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">Index</span><span class="p">(</span><span class="s2">&quot;my_index&quot;</span><span class="p">,</span> <span class="n">mssql_clustered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mssql_columnstore</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># required to associate the index with the table</span>
<span class="n">table</span><span class="o">.</span><span class="n">append_constraint</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></pre></div>
</div>
<p>the above renders the index as
<code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">CLUSTERED</span> <span class="pre">COLUMNSTORE</span> <span class="pre">INDEX</span> <span class="pre">my_index</span> <span class="pre">ON</span> <span class="pre">table</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.0.18.</span></p>
</div>
</section>
<section id="mssql-specific-index-options">
<h2>MSSQL-Specific Index Options<a class="headerlink" href="#mssql-specific-index-options" title="Link to this heading">¶</a></h2>
<p>In addition to clustering, the MSSQL dialect supports other special options
for <a class="reference internal" href="../core/constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a>.</p>
<section id="include">
<h3>INCLUDE<a class="headerlink" href="#include" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">mssql_include</span></code> option renders INCLUDE(colname) for the given string
names:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">(</span><span class="s2">&quot;my_index&quot;</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mssql_include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span></pre></div>
</div>
<p>would render the index as <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">INDEX</span> <span class="pre">my_index</span> <span class="pre">ON</span> <span class="pre">table</span> <span class="pre">(x)</span> <span class="pre">INCLUDE</span> <span class="pre">(y)</span></code></p>
</section>
<section id="filtered-indexes">
<span id="mssql-index-where"></span><h3>Filtered Indexes<a class="headerlink" href="#filtered-indexes" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">mssql_where</span></code> option renders WHERE(condition) for the given string
names:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">(</span><span class="s2">&quot;my_index&quot;</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mssql_where</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span></pre></div>
</div>
<p>would render the index as <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">INDEX</span> <span class="pre">my_index</span> <span class="pre">ON</span> <span class="pre">table</span> <span class="pre">(x)</span> <span class="pre">WHERE</span> <span class="pre">x</span> <span class="pre">&gt;</span> <span class="pre">10</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.4.</span></p>
</div>
</section>
<section id="index-ordering">
<h3>Index ordering<a class="headerlink" href="#index-ordering" title="Link to this heading">¶</a></h3>
<p>Index ordering is available via functional expressions, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">(</span><span class="s2">&quot;my_index&quot;</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span></pre></div>
</div>
<p>would render the index as <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">INDEX</span> <span class="pre">my_index</span> <span class="pre">ON</span> <span class="pre">table</span> <span class="pre">(x</span> <span class="pre">DESC)</span></code></p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../core/constraints.html#schema-indexes-functional"><span class="std std-ref">Functional Indexes</span></a></p>
</div>
</section>
</section>
<section id="compatibility-levels">
<h2>Compatibility Levels<a class="headerlink" href="#compatibility-levels" title="Link to this heading">¶</a></h2>
<p>MSSQL supports the notion of setting compatibility levels at the
database level. This allows, for instance, to run a database that
is compatible with SQL2000 while running on a SQL2005 database
server. <code class="docutils literal notranslate"><span class="pre">server_version_info</span></code> will always return the database
server version information (in this case SQL2005) and not the
compatibility level information. Because of this, if running under
a backwards compatibility mode SQLAlchemy may attempt to use T-SQL
statements that are unable to be parsed by the database server.</p>
</section>
<section id="triggers">
<span id="mssql-triggers"></span><h2>Triggers<a class="headerlink" href="#triggers" title="Link to this heading">¶</a></h2>
<p>SQLAlchemy by default uses OUTPUT INSERTED to get at newly
generated primary key values via IDENTITY columns or other
server side defaults.   MS-SQL does not
allow the usage of OUTPUT INSERTED on tables that have triggers.
To disable the usage of OUTPUT INSERTED on a per-table basis,
specify <code class="docutils literal notranslate"><span class="pre">implicit_returning=False</span></code> for each <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>
which has triggers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s1">&#39;mytable&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="c1"># ...,</span>
    <span class="n">implicit_returning</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span></pre></div>
</div>
<p>Declarative form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="c1"># ...</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;implicit_returning&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span></pre><div class="code-non-annotations-key"></div></div>
</div>
</section>
<section id="rowcount-support-orm-versioning">
<span id="mssql-rowcount-versioning"></span><h2>Rowcount Support / ORM Versioning<a class="headerlink" href="#rowcount-support-orm-versioning" title="Link to this heading">¶</a></h2>
<p>The SQL Server drivers may have limited ability to return the number
of rows updated from an UPDATE or DELETE statement.</p>
<p>As of this writing, the PyODBC driver is not able to return a rowcount when
OUTPUT INSERTED is used.    Previous versions of SQLAlchemy therefore had
limitations for features such as the “ORM Versioning” feature that relies upon
accurate rowcounts in order to match version numbers with matched rows.</p>
<p>SQLAlchemy 2.0 now retrieves the “rowcount” manually for these particular use
cases based on counting the rows that arrived back within RETURNING; so while
the driver still has this limitation, the ORM Versioning feature is no longer
impacted by it. As of SQLAlchemy 2.0.5, ORM versioning has been fully
re-enabled for the pyodbc driver.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0.5: </span>ORM versioning support is restored for the pyodbc
driver.  Previously, a warning would be emitted during ORM flush that
versioning was not supported.</p>
</div>
</section>
<section id="enabling-snapshot-isolation">
<h2>Enabling Snapshot Isolation<a class="headerlink" href="#enabling-snapshot-isolation" title="Link to this heading">¶</a></h2>
<p>SQL Server has a default transaction
isolation mode that locks entire tables, and causes even mildly concurrent
applications to have long held locks and frequent deadlocks.
Enabling snapshot isolation for the database as a whole is recommended
for modern levels of concurrency support.  This is accomplished via the
following ALTER DATABASE commands executed at the SQL prompt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALTER</span> <span class="n">DATABASE</span> <span class="n">MyDatabase</span> <span class="n">SET</span> <span class="n">ALLOW_SNAPSHOT_ISOLATION</span> <span class="n">ON</span>

<span class="n">ALTER</span> <span class="n">DATABASE</span> <span class="n">MyDatabase</span> <span class="n">SET</span> <span class="n">READ_COMMITTED_SNAPSHOT</span> <span class="n">ON</span></pre></div>
</div>
<p>Background on SQL Server snapshot isolation is available at
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/ms175095.aspx">https://msdn.microsoft.com/en-us/library/ms175095.aspx</a>.</p>
</section>
<section id="sql-server-sql-constructs">
<h2>SQL Server SQL Constructs<a class="headerlink" href="#sql-server-sql-constructs" title="Link to this heading">¶</a></h2>
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head">Object Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.try_cast"><span class="sig-name descname">try_cast</span></a>(expression, type_)</p></td>
<td><p>Produce a <code class="docutils literal notranslate"><span class="pre">TRY_CAST</span></code> expression for backends which support it;
this is a <code class="docutils literal notranslate"><span class="pre">CAST</span></code> which returns NULL for un-castable conversions.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.try_cast">
<em class="property"><span class="pre">function</span> </em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">try_cast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expression</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnExpressionOrLiteralArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_TypeEngineArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">_T</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.TryCast" title="sqlalchemy.sql.expression.TryCast"><span class="pre">TryCast</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_T</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.try_cast" title="Link to this definition">¶</a></dt>
<dd><p>Produce a <code class="docutils literal notranslate"><span class="pre">TRY_CAST</span></code> expression for backends which support it;
this is a <code class="docutils literal notranslate"><span class="pre">CAST</span></code> which returns NULL for un-castable conversions.</p>
<p>In SQLAlchemy, this construct is supported <strong>only</strong> by the SQL Server
dialect, and will raise a <a class="reference internal" href="../core/exceptions.html#sqlalchemy.exc.CompileError" title="sqlalchemy.exc.CompileError"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompileError</span></code></a> if used on other
included backends.  However, third party backends may also support
this construct.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>As <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.try_cast" title="sqlalchemy.sql.expression.try_cast"><code class="xref py py-func docutils literal notranslate"><span class="pre">try_cast()</span></code></a> originates from the SQL Server dialect,
it’s importable both from <code class="docutils literal notranslate"><span class="pre">sqlalchemy.</span></code> as well as from
<code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql</span></code>.</p>
</div>
<p><a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.try_cast" title="sqlalchemy.sql.expression.try_cast"><code class="xref py py-func docutils literal notranslate"><span class="pre">try_cast()</span></code></a> returns an instance of <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.TryCast" title="sqlalchemy.sql.expression.TryCast"><code class="xref py py-class docutils literal notranslate"><span class="pre">TryCast</span></code></a> and
generally behaves similarly to the <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.Cast" title="sqlalchemy.sql.expression.Cast"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cast</span></code></a> construct;
at the SQL level, the difference between <code class="docutils literal notranslate"><span class="pre">CAST</span></code> and <code class="docutils literal notranslate"><span class="pre">TRY_CAST</span></code>
is that <code class="docutils literal notranslate"><span class="pre">TRY_CAST</span></code> returns NULL for an un-castable expression,
such as attempting to cast a string <code class="docutils literal notranslate"><span class="pre">&quot;hi&quot;</span></code> to an integer value.</p>
<p>E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">select</span><span class="p">,</span> <span class="n">try_cast</span><span class="p">,</span> <span class="n">Numeric</span>

<span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span>
    <span class="n">try_cast</span><span class="p">(</span><span class="n">product_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">unit_price</span><span class="p">,</span> <span class="n">Numeric</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="p">)</span></pre></div>
</div>
<p>The above would render on Microsoft SQL Server as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">TRY_CAST</span> <span class="p">(</span><span class="n">product_table</span><span class="o">.</span><span class="n">unit_price</span> <span class="n">AS</span> <span class="n">NUMERIC</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">FROM</span> <span class="n">product_table</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.0.14: </span><a class="reference internal" href="#sqlalchemy.dialects.mssql.try_cast" title="sqlalchemy.dialects.mssql.try_cast"><code class="xref py py-func docutils literal notranslate"><span class="pre">try_cast()</span></code></a> has been
generalized from the SQL Server dialect into a general use
construct that may be supported by additional dialects.</p>
</div>
</dd></dl>

</section>
<section id="sql-server-data-types">
<h2>SQL Server Data Types<a class="headerlink" href="#sql-server-data-types" title="Link to this heading">¶</a></h2>
<p>As with all SQLAlchemy dialects, all UPPERCASE types that are known to be
valid with SQL server are importable from the top level dialect, whether
they originate from <a class="reference internal" href="../core/type_basics.html#module-sqlalchemy.types" title="sqlalchemy.types"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlalchemy.types</span></code></a> or from the local dialect:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.mssql</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BIGINT</span><span class="p">,</span>
    <span class="n">BINARY</span><span class="p">,</span>
    <span class="n">BIT</span><span class="p">,</span>
    <span class="n">CHAR</span><span class="p">,</span>
    <span class="n">DATE</span><span class="p">,</span>
    <span class="n">DATETIME</span><span class="p">,</span>
    <span class="n">DATETIME2</span><span class="p">,</span>
    <span class="n">DATETIMEOFFSET</span><span class="p">,</span>
    <span class="n">DECIMAL</span><span class="p">,</span>
    <span class="n">DOUBLE_PRECISION</span><span class="p">,</span>
    <span class="n">FLOAT</span><span class="p">,</span>
    <span class="n">IMAGE</span><span class="p">,</span>
    <span class="n">INTEGER</span><span class="p">,</span>
    <span class="n">JSON</span><span class="p">,</span>
    <span class="n">MONEY</span><span class="p">,</span>
    <span class="n">NCHAR</span><span class="p">,</span>
    <span class="n">NTEXT</span><span class="p">,</span>
    <span class="n">NUMERIC</span><span class="p">,</span>
    <span class="n">NVARCHAR</span><span class="p">,</span>
    <span class="n">REAL</span><span class="p">,</span>
    <span class="n">SMALLDATETIME</span><span class="p">,</span>
    <span class="n">SMALLINT</span><span class="p">,</span>
    <span class="n">SMALLMONEY</span><span class="p">,</span>
    <span class="n">SQL_VARIANT</span><span class="p">,</span>
    <span class="n">TEXT</span><span class="p">,</span>
    <span class="n">TIME</span><span class="p">,</span>
    <span class="n">TIMESTAMP</span><span class="p">,</span>
    <span class="n">TINYINT</span><span class="p">,</span>
    <span class="n">UNIQUEIDENTIFIER</span><span class="p">,</span>
    <span class="n">VARBINARY</span><span class="p">,</span>
    <span class="n">VARCHAR</span><span class="p">,</span>
<span class="p">)</span></pre></div>
</div>
<p>Types which are specific to SQL Server, or have SQL Server-specific
construction arguments, are as follows:</p>
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head">Object Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.BIT"><span class="sig-name descname">BIT</span></a></p></td>
<td><p>MSSQL BIT type.</p></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.DATETIME2"><span class="sig-name descname">DATETIME2</span></a></p></td>
<td></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.DATETIMEOFFSET"><span class="sig-name descname">DATETIMEOFFSET</span></a></p></td>
<td></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.DOUBLE_PRECISION"><span class="sig-name descname">DOUBLE_PRECISION</span></a></p></td>
<td><p>the SQL Server DOUBLE PRECISION datatype.</p></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.IMAGE"><span class="sig-name descname">IMAGE</span></a></p></td>
<td></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.JSON"><span class="sig-name descname">JSON</span></a></p></td>
<td><p>MSSQL JSON type.</p></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.MONEY"><span class="sig-name descname">MONEY</span></a></p></td>
<td></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.NTEXT"><span class="sig-name descname">NTEXT</span></a></p></td>
<td><p>MSSQL NTEXT type, for variable-length unicode text up to 2^30
characters.</p></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.REAL"><span class="sig-name descname">REAL</span></a></p></td>
<td><p>the SQL Server REAL datatype.</p></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.ROWVERSION"><span class="sig-name descname">ROWVERSION</span></a></p></td>
<td><p>Implement the SQL Server ROWVERSION type.</p></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.SMALLDATETIME"><span class="sig-name descname">SMALLDATETIME</span></a></p></td>
<td></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.SMALLMONEY"><span class="sig-name descname">SMALLMONEY</span></a></p></td>
<td></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.SQL_VARIANT"><span class="sig-name descname">SQL_VARIANT</span></a></p></td>
<td></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.TIME"><span class="sig-name descname">TIME</span></a></p></td>
<td></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.TIMESTAMP"><span class="sig-name descname">TIMESTAMP</span></a></p></td>
<td><p>Implement the SQL Server TIMESTAMP type.</p></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.TINYINT"><span class="sig-name descname">TINYINT</span></a></p></td>
<td></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER"><span class="sig-name descname">UNIQUEIDENTIFIER</span></a></p></td>
<td></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.dialects.mssql.XML"><span class="sig-name descname">XML</span></a></p></td>
<td><p>MSSQL XML type.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.BIT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">BIT</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.BIT" title="Link to this definition">¶</a></dt>
<dd><p>MSSQL BIT type.</p>
<p>Both pyodbc and pymssql return values from BIT columns as
Python &lt;class ‘bool’&gt; so just subclass Boolean.</p>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.dialects.mssql.BIT.__init__"><span class="sig-name descname">__init__()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.BIT" title="sqlalchemy.dialects.mssql.BIT"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.BIT</span></code></a> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Boolean" title="sqlalchemy.types.Boolean"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Boolean</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.BIT.__init__">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.BIT"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.BIT.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">create_constraint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_create_events</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_adapted_from</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.SchemaType" title="sqlalchemy.sql.sqltypes.SchemaType"><span class="pre">SchemaType</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.mssql.BIT.__init__" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="docutils literal notranslate"><span class="pre">sqlalchemy.types.Boolean.__init__</span></code> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Boolean" title="sqlalchemy.types.Boolean"><code class="xref py py-class docutils literal notranslate"><span class="pre">Boolean</span></code></a></p>
</div>
<p>Construct a Boolean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.dialects.mssql.BIT.params.create_constraint"></span><strong>create_constraint</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.BIT.params.create_constraint">¶</a> – <p>defaults to False.  If the boolean
is generated as an int/smallint, also create a CHECK constraint
on the table that ensures 1 or 0 as a value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>it is strongly recommended that the CHECK constraint
have an explicit name in order to support schema-management
concerns.  This can be established either by setting the
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Boolean.params.name" title="sqlalchemy.types.Boolean"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Boolean.name</span></code></a> parameter or by setting up an
appropriate naming convention; see
<a class="reference internal" href="../core/constraints.html#constraint-naming-conventions"><span class="std std-ref">Configuring Constraint Naming Conventions</span></a> for background.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4: </span>- this flag now defaults to False, meaning
no CHECK constraint is generated for a non-native enumerated
type.</p>
</div>
</p></li>
<li><p><span class="target" id="sqlalchemy.dialects.mssql.BIT.params.name"></span><strong>name</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.BIT.params.name">¶</a> – if a CHECK constraint is generated, specify
the name of the constraint.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">CHAR</span></span></dt>
<dd><p>The SQL CHAR type.</p>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.CHAR</span></code> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.String</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.CHAR"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.CHAR.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="docutils literal notranslate"><span class="pre">sqlalchemy.types.String.__init__</span></code> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal notranslate"><span class="pre">String</span></code></a></p>
</div>
<p>Create a string-holding type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.dialects.mssql.CHAR.params.length"></span><strong>length</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.CHAR.params.length">¶</a> – optional, a length for the column for use in
DDL and CAST expressions.  May be safely omitted if no <code class="docutils literal notranslate"><span class="pre">CREATE</span>
<span class="pre">TABLE</span></code> will be issued.  Certain databases may require a
<code class="docutils literal notranslate"><span class="pre">length</span></code> for use in DDL, and will raise an exception when
the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> DDL is issued if a <code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code>
with no length is included.  Whether the value is
interpreted as bytes or characters is database specific.</p></li>
<li><p><span class="target" id="sqlalchemy.dialects.mssql.CHAR.params.collation"></span><strong>collation</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.CHAR.params.collation">¶</a> – <p>Optional, a column-level collation for
use in DDL and CAST expressions.  Renders using the
COLLATE keyword supported by SQLite, MySQL, and PostgreSQL.
E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">cast</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">String</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;some string&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="n">collation</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">))))</span>
<div class='show_sql_print'><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(:</span><span class="n">param_1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">utf8</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">anon_1</span>
</div></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases, the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Unicode" title="sqlalchemy.types.Unicode"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unicode</span></code></a> or <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnicodeText</span></code></a>
datatypes should be used for a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> that expects
to store non-ascii data. These datatypes will ensure that the
correct types are used on the database.</p>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.DATETIME2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">DATETIME2</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.DATETIME2" title="Link to this definition">¶</a></dt>
<dd><div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.DATETIME2" title="sqlalchemy.dialects.mssql.DATETIME2"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.DATETIME2</span></code></a> (<code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.base._DateTimeBase</span></code>, <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.DateTime" title="sqlalchemy.types.DateTime"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.DateTime</span></code></a>)</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.DATETIMEOFFSET">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">DATETIMEOFFSET</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.DATETIMEOFFSET" title="Link to this definition">¶</a></dt>
<dd><div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.DATETIMEOFFSET" title="sqlalchemy.dialects.mssql.DATETIMEOFFSET"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.DATETIMEOFFSET</span></code></a> (<code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.base._DateTimeBase</span></code>, <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.DateTime" title="sqlalchemy.types.DateTime"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.DateTime</span></code></a>)</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.DOUBLE_PRECISION">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">DOUBLE_PRECISION</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.DOUBLE_PRECISION" title="Link to this definition">¶</a></dt>
<dd><p>the SQL Server DOUBLE PRECISION datatype.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.0.11.</span></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.DOUBLE_PRECISION" title="sqlalchemy.dialects.mssql.DOUBLE_PRECISION"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.DOUBLE_PRECISION</span></code></a> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.DOUBLE_PRECISION" title="sqlalchemy.types.DOUBLE_PRECISION"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.DOUBLE_PRECISION</span></code></a>)</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.IMAGE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">IMAGE</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.IMAGE" title="Link to this definition">¶</a></dt>
<dd><div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.dialects.mssql.IMAGE.__init__"><span class="sig-name descname">__init__()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.IMAGE" title="sqlalchemy.dialects.mssql.IMAGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.IMAGE</span></code></a> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.LargeBinary" title="sqlalchemy.types.LargeBinary"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.LargeBinary</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.IMAGE.__init__">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.IMAGE"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.IMAGE.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.mssql.IMAGE.__init__" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="docutils literal notranslate"><span class="pre">sqlalchemy.types.LargeBinary.__init__</span></code> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.LargeBinary" title="sqlalchemy.types.LargeBinary"><code class="xref py py-class docutils literal notranslate"><span class="pre">LargeBinary</span></code></a></p>
</div>
<p>Construct a LargeBinary type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.dialects.mssql.IMAGE.params.length"></span><strong>length</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.IMAGE.params.length">¶</a> – optional, a length for the column for use in
DDL statements, for those binary types that accept a length,
such as the MySQL BLOB type.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.JSON">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">JSON</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.JSON" title="Link to this definition">¶</a></dt>
<dd><p>MSSQL JSON type.</p>
<p>MSSQL supports JSON-formatted data as of SQL Server 2016.</p>
<p>The <a class="reference internal" href="#sqlalchemy.dialects.mssql.JSON" title="sqlalchemy.dialects.mssql.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a> datatype at the DDL level will represent the
datatype as <code class="docutils literal notranslate"><span class="pre">NVARCHAR(max)</span></code>, but provides for JSON-level comparison
functions as well as Python coercion behavior.</p>
<p><a class="reference internal" href="#sqlalchemy.dialects.mssql.JSON" title="sqlalchemy.dialects.mssql.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a> is used automatically whenever the base
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON" title="sqlalchemy.types.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a> datatype is used against a SQL Server backend.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON" title="sqlalchemy.types.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a> - main documentation for the generic
cross-platform JSON datatype.</p>
</div>
<p>The <a class="reference internal" href="#sqlalchemy.dialects.mssql.JSON" title="sqlalchemy.dialects.mssql.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a> type supports persistence of JSON values
as well as the core index operations provided by <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON" title="sqlalchemy.types.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a>
datatype, by adapting the operations to render the <code class="docutils literal notranslate"><span class="pre">JSON_VALUE</span></code>
or <code class="docutils literal notranslate"><span class="pre">JSON_QUERY</span></code> functions at the database level.</p>
<p>The SQL Server <a class="reference internal" href="#sqlalchemy.dialects.mssql.JSON" title="sqlalchemy.dialects.mssql.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a> type necessarily makes use of the
<code class="docutils literal notranslate"><span class="pre">JSON_QUERY</span></code> and <code class="docutils literal notranslate"><span class="pre">JSON_VALUE</span></code> functions when querying for elements
of a JSON object.   These two functions have a major restriction in that
they are <strong>mutually exclusive</strong> based on the type of object to be returned.
The <code class="docutils literal notranslate"><span class="pre">JSON_QUERY</span></code> function <strong>only</strong> returns a JSON dictionary or list,
but not an individual string, numeric, or boolean element; the
<code class="docutils literal notranslate"><span class="pre">JSON_VALUE</span></code> function <strong>only</strong> returns an individual string, numeric,
or boolean element.   <strong>both functions either return NULL or raise
an error if they are not used against the correct expected value</strong>.</p>
<p>To handle this awkward requirement, indexed access rules are as follows:</p>
<ol class="arabic">
<li><p>When extracting a sub element from a JSON that is itself a JSON
dictionary or list, the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.Comparator.as_json" title="sqlalchemy.types.JSON.Comparator.as_json"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.as_json()</span></code></a> accessor
should be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span>
    <span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;some key&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">as_json</span><span class="p">()</span>
<span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;some key&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">as_json</span><span class="p">()</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;sub&quot;</span><span class="p">:</span> <span class="s2">&quot;structure&quot;</span><span class="p">}</span>
<span class="p">)</span></pre></div>
</div>
</li>
<li><p>When extracting a sub element from a JSON that is a plain boolean,
string, integer, or float, use the appropriate method among
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.Comparator.as_boolean" title="sqlalchemy.types.JSON.Comparator.as_boolean"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.as_boolean()</span></code></a>,
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.Comparator.as_string" title="sqlalchemy.types.JSON.Comparator.as_string"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.as_string()</span></code></a>,
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.Comparator.as_integer" title="sqlalchemy.types.JSON.Comparator.as_integer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.as_integer()</span></code></a>,
<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.Comparator.as_float" title="sqlalchemy.types.JSON.Comparator.as_float"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Comparator.as_float()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span>
    <span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;some key&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span>
<span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">data_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;some key&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">as_string</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;some string&quot;</span>
<span class="p">)</span></pre></div>
</div>
</li>
</ol>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.4.</span></p>
</div>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.dialects.mssql.JSON.__init__"><span class="sig-name descname">__init__()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.JSON" title="sqlalchemy.dialects.mssql.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.JSON</span></code></a> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON" title="sqlalchemy.types.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.JSON</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.JSON.__init__">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.JSON"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.JSON.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">none_as_null</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.mssql.JSON.__init__" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="docutils literal notranslate"><span class="pre">sqlalchemy.types.JSON.__init__</span></code> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON" title="sqlalchemy.types.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a></p>
</div>
<p>Construct a <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON" title="sqlalchemy.types.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a> type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.dialects.mssql.JSON.params.none_as_null"></span><strong>none_as_null=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.JSON.params.none_as_null">¶</a> – <p>if True, persist the value <code class="docutils literal notranslate"><span class="pre">None</span></code> as a
SQL NULL value, not the JSON encoding of <code class="docutils literal notranslate"><span class="pre">null</span></code>. Note that when this
flag is False, the <a class="reference internal" href="../core/sqlelement.html#sqlalchemy.sql.expression.null" title="sqlalchemy.sql.expression.null"><code class="xref py py-func docutils literal notranslate"><span class="pre">null()</span></code></a> construct can still be used to
persist a NULL value, which may be passed directly as a parameter
value that is specially interpreted by the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON" title="sqlalchemy.types.JSON"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSON</span></code></a> type
as SQL NULL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">null</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">insert</span><span class="p">(),</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">()})</span></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.params.none_as_null" title="sqlalchemy.types.JSON"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">JSON.none_as_null</span></code></a> does <strong>not</strong> apply to the
values passed to <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column.params.default" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.default</span></code></a> and
<a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column.params.server_default" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.server_default</span></code></a>; a value of <code class="docutils literal notranslate"><span class="pre">None</span></code>
passed for these parameters means “no default present”.</p>
<p>Additionally, when used in SQL comparison expressions, the
Python value <code class="docutils literal notranslate"><span class="pre">None</span></code> continues to refer to SQL null, and not
JSON NULL.  The <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.params.none_as_null" title="sqlalchemy.types.JSON"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">JSON.none_as_null</span></code></a> flag refers
explicitly to the <strong>persistence</strong> of the value within an
INSERT or UPDATE statement.   The <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.NULL" title="sqlalchemy.types.JSON.NULL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">JSON.NULL</span></code></a>
value should be used for SQL expressions that wish to compare to
JSON null.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.JSON.NULL" title="sqlalchemy.types.JSON.NULL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">JSON.NULL</span></code></a></p>
</div>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.MONEY">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">MONEY</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.MONEY" title="Link to this definition">¶</a></dt>
<dd><div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.MONEY" title="sqlalchemy.dialects.mssql.MONEY"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.MONEY</span></code></a> (<a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a>)</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">NCHAR</span></span></dt>
<dd><p>The SQL NCHAR type.</p>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.NCHAR</span></code> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Unicode" title="sqlalchemy.types.Unicode"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Unicode</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.NCHAR"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.NCHAR.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="docutils literal notranslate"><span class="pre">sqlalchemy.types.String.__init__</span></code> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal notranslate"><span class="pre">String</span></code></a></p>
</div>
<p>Create a string-holding type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.dialects.mssql.NCHAR.params.length"></span><strong>length</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.NCHAR.params.length">¶</a> – optional, a length for the column for use in
DDL and CAST expressions.  May be safely omitted if no <code class="docutils literal notranslate"><span class="pre">CREATE</span>
<span class="pre">TABLE</span></code> will be issued.  Certain databases may require a
<code class="docutils literal notranslate"><span class="pre">length</span></code> for use in DDL, and will raise an exception when
the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> DDL is issued if a <code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code>
with no length is included.  Whether the value is
interpreted as bytes or characters is database specific.</p></li>
<li><p><span class="target" id="sqlalchemy.dialects.mssql.NCHAR.params.collation"></span><strong>collation</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.NCHAR.params.collation">¶</a> – <p>Optional, a column-level collation for
use in DDL and CAST expressions.  Renders using the
COLLATE keyword supported by SQLite, MySQL, and PostgreSQL.
E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">cast</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">String</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;some string&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="n">collation</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">))))</span>
<div class='show_sql_print'><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(:</span><span class="n">param_1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">utf8</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">anon_1</span>
</div></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases, the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Unicode" title="sqlalchemy.types.Unicode"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unicode</span></code></a> or <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnicodeText</span></code></a>
datatypes should be used for a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> that expects
to store non-ascii data. These datatypes will ensure that the
correct types are used on the database.</p>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.NTEXT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">NTEXT</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.NTEXT" title="Link to this definition">¶</a></dt>
<dd><p>MSSQL NTEXT type, for variable-length unicode text up to 2^30
characters.</p>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.dialects.mssql.NTEXT.__init__"><span class="sig-name descname">__init__()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.NTEXT" title="sqlalchemy.dialects.mssql.NTEXT"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.NTEXT</span></code></a> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.UnicodeText</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.NTEXT.__init__">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.NTEXT"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.NTEXT.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.mssql.NTEXT.__init__" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="docutils literal notranslate"><span class="pre">sqlalchemy.types.String.__init__</span></code> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal notranslate"><span class="pre">String</span></code></a></p>
</div>
<p>Create a string-holding type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.dialects.mssql.NTEXT.params.length"></span><strong>length</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.NTEXT.params.length">¶</a> – optional, a length for the column for use in
DDL and CAST expressions.  May be safely omitted if no <code class="docutils literal notranslate"><span class="pre">CREATE</span>
<span class="pre">TABLE</span></code> will be issued.  Certain databases may require a
<code class="docutils literal notranslate"><span class="pre">length</span></code> for use in DDL, and will raise an exception when
the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> DDL is issued if a <code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code>
with no length is included.  Whether the value is
interpreted as bytes or characters is database specific.</p></li>
<li><p><span class="target" id="sqlalchemy.dialects.mssql.NTEXT.params.collation"></span><strong>collation</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.NTEXT.params.collation">¶</a> – <p>Optional, a column-level collation for
use in DDL and CAST expressions.  Renders using the
COLLATE keyword supported by SQLite, MySQL, and PostgreSQL.
E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">cast</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">String</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;some string&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="n">collation</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">))))</span>
<div class='show_sql_print'><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(:</span><span class="n">param_1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">utf8</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">anon_1</span>
</div></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases, the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Unicode" title="sqlalchemy.types.Unicode"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unicode</span></code></a> or <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnicodeText</span></code></a>
datatypes should be used for a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> that expects
to store non-ascii data. These datatypes will ensure that the
correct types are used on the database.</p>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">NVARCHAR</span></span></dt>
<dd><p>The SQL NVARCHAR type.</p>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.NVARCHAR</span></code> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Unicode" title="sqlalchemy.types.Unicode"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Unicode</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.NVARCHAR"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.NVARCHAR.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="docutils literal notranslate"><span class="pre">sqlalchemy.types.String.__init__</span></code> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal notranslate"><span class="pre">String</span></code></a></p>
</div>
<p>Create a string-holding type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.dialects.mssql.NVARCHAR.params.length"></span><strong>length</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.NVARCHAR.params.length">¶</a> – optional, a length for the column for use in
DDL and CAST expressions.  May be safely omitted if no <code class="docutils literal notranslate"><span class="pre">CREATE</span>
<span class="pre">TABLE</span></code> will be issued.  Certain databases may require a
<code class="docutils literal notranslate"><span class="pre">length</span></code> for use in DDL, and will raise an exception when
the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> DDL is issued if a <code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code>
with no length is included.  Whether the value is
interpreted as bytes or characters is database specific.</p></li>
<li><p><span class="target" id="sqlalchemy.dialects.mssql.NVARCHAR.params.collation"></span><strong>collation</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.NVARCHAR.params.collation">¶</a> – <p>Optional, a column-level collation for
use in DDL and CAST expressions.  Renders using the
COLLATE keyword supported by SQLite, MySQL, and PostgreSQL.
E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">cast</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">String</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;some string&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="n">collation</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">))))</span>
<div class='show_sql_print'><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(:</span><span class="n">param_1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">utf8</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">anon_1</span>
</div></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases, the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Unicode" title="sqlalchemy.types.Unicode"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unicode</span></code></a> or <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnicodeText</span></code></a>
datatypes should be used for a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> that expects
to store non-ascii data. These datatypes will ensure that the
correct types are used on the database.</p>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.REAL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">REAL</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.REAL" title="Link to this definition">¶</a></dt>
<dd><p>the SQL Server REAL datatype.</p>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.REAL" title="sqlalchemy.dialects.mssql.REAL"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.REAL</span></code></a> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.REAL" title="sqlalchemy.types.REAL"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.REAL</span></code></a>)</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.ROWVERSION">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">ROWVERSION</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.ROWVERSION" title="Link to this definition">¶</a></dt>
<dd><p>Implement the SQL Server ROWVERSION type.</p>
<p>The ROWVERSION datatype is a SQL Server synonym for the TIMESTAMP
datatype, however current SQL Server documentation suggests using
ROWVERSION for new datatypes going forward.</p>
<p>The ROWVERSION datatype does <strong>not</strong> reflect (e.g. introspect) from the
database as itself; the returned datatype will be
<a class="reference internal" href="#sqlalchemy.dialects.mssql.TIMESTAMP" title="sqlalchemy.dialects.mssql.TIMESTAMP"><code class="xref py py-class docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></a>.</p>
<p>This is a read-only datatype that does not support INSERT of values.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sqlalchemy.dialects.mssql.TIMESTAMP" title="sqlalchemy.dialects.mssql.TIMESTAMP"><code class="xref py py-class docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></a></p>
</div>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.dialects.mssql.ROWVERSION.__init__"><span class="sig-name descname">__init__()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.ROWVERSION" title="sqlalchemy.dialects.mssql.ROWVERSION"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.ROWVERSION</span></code></a> (<a class="reference internal" href="#sqlalchemy.dialects.mssql.TIMESTAMP" title="sqlalchemy.dialects.mssql.base.TIMESTAMP"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.base.TIMESTAMP</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.ROWVERSION.__init__">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.ROWVERSION"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.ROWVERSION.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">convert_int</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.mssql.ROWVERSION.__init__" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.base.TIMESTAMP.__init__</span></code> <em>method of</em> <a class="reference internal" href="#sqlalchemy.dialects.mssql.TIMESTAMP" title="sqlalchemy.dialects.mssql.base.TIMESTAMP"><code class="xref py py-class docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></a></p>
</div>
<p>Construct a TIMESTAMP or ROWVERSION type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.dialects.mssql.ROWVERSION.params.convert_int"></span><strong>convert_int</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.ROWVERSION.params.convert_int">¶</a> – if True, binary integer values will
be converted to integers on read.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.SMALLDATETIME">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">SMALLDATETIME</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.SMALLDATETIME" title="Link to this definition">¶</a></dt>
<dd><div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.dialects.mssql.SMALLDATETIME.__init__"><span class="sig-name descname">__init__()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.SMALLDATETIME" title="sqlalchemy.dialects.mssql.SMALLDATETIME"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.SMALLDATETIME</span></code></a> (<code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.base._DateTimeBase</span></code>, <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.DateTime" title="sqlalchemy.types.DateTime"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.DateTime</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.SMALLDATETIME.__init__">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.SMALLDATETIME"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.SMALLDATETIME.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timezone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.mssql.SMALLDATETIME.__init__" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="docutils literal notranslate"><span class="pre">sqlalchemy.types.DateTime.__init__</span></code> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.DateTime" title="sqlalchemy.types.DateTime"><code class="xref py py-class docutils literal notranslate"><span class="pre">DateTime</span></code></a></p>
</div>
<p>Construct a new <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.DateTime" title="sqlalchemy.types.DateTime"><code class="xref py py-class docutils literal notranslate"><span class="pre">DateTime</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.dialects.mssql.SMALLDATETIME.params.timezone"></span><strong>timezone</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.SMALLDATETIME.params.timezone">¶</a> – boolean.  Indicates that the datetime type should
enable timezone support, if available on the
<strong>base date/time-holding type only</strong>.   It is recommended
to make use of the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.TIMESTAMP" title="sqlalchemy.types.TIMESTAMP"><code class="xref py py-class docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></a> datatype directly when
using this flag, as some databases include separate generic
date/time-holding types distinct from the timezone-capable
TIMESTAMP datatype, such as Oracle.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.SMALLMONEY">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">SMALLMONEY</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.SMALLMONEY" title="Link to this definition">¶</a></dt>
<dd><div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.SMALLMONEY" title="sqlalchemy.dialects.mssql.SMALLMONEY"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.SMALLMONEY</span></code></a> (<a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a>)</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.SQL_VARIANT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">SQL_VARIANT</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.SQL_VARIANT" title="Link to this definition">¶</a></dt>
<dd><div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.SQL_VARIANT" title="sqlalchemy.dialects.mssql.SQL_VARIANT"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.SQL_VARIANT</span></code></a> (<a class="reference internal" href="../core/type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TypeEngine</span></code></a>)</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">TEXT</span></span></dt>
<dd><p>The SQL TEXT type.</p>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.TEXT</span></code> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Text" title="sqlalchemy.types.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Text</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.TEXT"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.TEXT.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="docutils literal notranslate"><span class="pre">sqlalchemy.types.String.__init__</span></code> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal notranslate"><span class="pre">String</span></code></a></p>
</div>
<p>Create a string-holding type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.dialects.mssql.TEXT.params.length"></span><strong>length</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.TEXT.params.length">¶</a> – optional, a length for the column for use in
DDL and CAST expressions.  May be safely omitted if no <code class="docutils literal notranslate"><span class="pre">CREATE</span>
<span class="pre">TABLE</span></code> will be issued.  Certain databases may require a
<code class="docutils literal notranslate"><span class="pre">length</span></code> for use in DDL, and will raise an exception when
the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> DDL is issued if a <code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code>
with no length is included.  Whether the value is
interpreted as bytes or characters is database specific.</p></li>
<li><p><span class="target" id="sqlalchemy.dialects.mssql.TEXT.params.collation"></span><strong>collation</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.TEXT.params.collation">¶</a> – <p>Optional, a column-level collation for
use in DDL and CAST expressions.  Renders using the
COLLATE keyword supported by SQLite, MySQL, and PostgreSQL.
E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">cast</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">String</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;some string&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="n">collation</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">))))</span>
<div class='show_sql_print'><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(:</span><span class="n">param_1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">utf8</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">anon_1</span>
</div></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases, the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Unicode" title="sqlalchemy.types.Unicode"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unicode</span></code></a> or <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnicodeText</span></code></a>
datatypes should be used for a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> that expects
to store non-ascii data. These datatypes will ensure that the
correct types are used on the database.</p>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.TIME">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">TIME</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.TIME" title="Link to this definition">¶</a></dt>
<dd><div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.TIME" title="sqlalchemy.dialects.mssql.TIME"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.TIME</span></code></a> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.TIME" title="sqlalchemy.types.TIME"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.TIME</span></code></a>)</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.TIMESTAMP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">TIMESTAMP</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.TIMESTAMP" title="Link to this definition">¶</a></dt>
<dd><p>Implement the SQL Server TIMESTAMP type.</p>
<p>Note this is <strong>completely different</strong> than the SQL Standard
TIMESTAMP type, which is not supported by SQL Server.  It
is a read-only datatype that does not support INSERT of values.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sqlalchemy.dialects.mssql.ROWVERSION" title="sqlalchemy.dialects.mssql.ROWVERSION"><code class="xref py py-class docutils literal notranslate"><span class="pre">ROWVERSION</span></code></a></p>
</div>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.dialects.mssql.TIMESTAMP.__init__"><span class="sig-name descname">__init__()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.TIMESTAMP" title="sqlalchemy.dialects.mssql.TIMESTAMP"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.TIMESTAMP</span></code></a> (<code class="docutils literal notranslate"><span class="pre">sqlalchemy.types._Binary</span></code>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.TIMESTAMP.__init__">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.TIMESTAMP"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.TIMESTAMP.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">convert_int</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.mssql.TIMESTAMP.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Construct a TIMESTAMP or ROWVERSION type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.dialects.mssql.TIMESTAMP.params.convert_int"></span><strong>convert_int</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.TIMESTAMP.params.convert_int">¶</a> – if True, binary integer values will
be converted to integers on read.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.TINYINT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">TINYINT</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.TINYINT" title="Link to this definition">¶</a></dt>
<dd><div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.TINYINT" title="sqlalchemy.dialects.mssql.TINYINT"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.TINYINT</span></code></a> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Integer" title="sqlalchemy.types.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Integer</span></code></a>)</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">UNIQUEIDENTIFIER</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER" title="Link to this definition">¶</a></dt>
<dd><div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER.__init__"><span class="sig-name descname">__init__()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER" title="sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER</span></code></a> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Uuid" title="sqlalchemy.types.Uuid"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Uuid</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER.__init__">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">as_uuid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Construct a <a class="reference internal" href="#sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER" title="sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER"><code class="xref py py-class docutils literal notranslate"><span class="pre">UNIQUEIDENTIFIER</span></code></a> type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER.params.as_uuid"></span><strong>as_uuid=True</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.UNIQUEIDENTIFIER.params.as_uuid">¶</a> – <p>if True, values will be interpreted
as Python uuid objects, converting to/from string via the
DBAPI.</p>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">VARBINARY</span></span></dt>
<dd><p>The MSSQL VARBINARY type.</p>
<p>This type adds additional features to the core <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.VARBINARY" title="sqlalchemy.types.VARBINARY"><code class="xref py py-class docutils literal notranslate"><span class="pre">VARBINARY</span></code></a>
type, including “deprecate_large_types” mode where
either <code class="docutils literal notranslate"><span class="pre">VARBINARY(max)</span></code> or IMAGE is rendered, as well as the SQL
Server <code class="docutils literal notranslate"><span class="pre">FILESTREAM</span></code> option.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#mssql-large-type-deprecation"><span class="std std-ref">Large Text/Binary Type Deprecation</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.VARBINARY</span></code> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.VARBINARY" title="sqlalchemy.types.VARBINARY"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.VARBINARY</span></code></a>, <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.LargeBinary" title="sqlalchemy.types.LargeBinary"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.LargeBinary</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.VARBINARY"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.VARBINARY.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filestream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Construct a VARBINARY type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.dialects.mssql.VARBINARY.params.length"></span><strong>length</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.VARBINARY.params.length">¶</a> – optional, a length for the column for use in
DDL statements, for those binary types that accept a length,
such as the MySQL BLOB type.</p></li>
<li><p><span class="target" id="sqlalchemy.dialects.mssql.VARBINARY.params.filestream"></span><strong>filestream=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.VARBINARY.params.filestream">¶</a> – <p>if True, renders the <code class="docutils literal notranslate"><span class="pre">FILESTREAM</span></code> keyword
in the table definition. In this case <code class="docutils literal notranslate"><span class="pre">length</span></code> must be <code class="docutils literal notranslate"><span class="pre">None</span></code>
or <code class="docutils literal notranslate"><span class="pre">'max'</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.4.31.</span></p>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">VARCHAR</span></span></dt>
<dd><p>The SQL VARCHAR type.</p>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.VARCHAR</span></code> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.String</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.VARCHAR"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.VARCHAR.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="docutils literal notranslate"><span class="pre">sqlalchemy.types.String.__init__</span></code> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal notranslate"><span class="pre">String</span></code></a></p>
</div>
<p>Create a string-holding type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.dialects.mssql.VARCHAR.params.length"></span><strong>length</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.VARCHAR.params.length">¶</a> – optional, a length for the column for use in
DDL and CAST expressions.  May be safely omitted if no <code class="docutils literal notranslate"><span class="pre">CREATE</span>
<span class="pre">TABLE</span></code> will be issued.  Certain databases may require a
<code class="docutils literal notranslate"><span class="pre">length</span></code> for use in DDL, and will raise an exception when
the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> DDL is issued if a <code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code>
with no length is included.  Whether the value is
interpreted as bytes or characters is database specific.</p></li>
<li><p><span class="target" id="sqlalchemy.dialects.mssql.VARCHAR.params.collation"></span><strong>collation</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.VARCHAR.params.collation">¶</a> – <p>Optional, a column-level collation for
use in DDL and CAST expressions.  Renders using the
COLLATE keyword supported by SQLite, MySQL, and PostgreSQL.
E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">cast</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">String</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;some string&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="n">collation</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">))))</span>
<div class='show_sql_print'><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(:</span><span class="n">param_1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">utf8</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">anon_1</span>
</div></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases, the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Unicode" title="sqlalchemy.types.Unicode"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unicode</span></code></a> or <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnicodeText</span></code></a>
datatypes should be used for a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> that expects
to store non-ascii data. These datatypes will ensure that the
correct types are used on the database.</p>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.XML">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.dialects.mssql.</span></span><span class="sig-name descname"><span class="pre">XML</span></span><a class="headerlink" href="#sqlalchemy.dialects.mssql.XML" title="Link to this definition">¶</a></dt>
<dd><p>MSSQL XML type.</p>
<p>This is a placeholder type for reflection purposes that does not include
any Python-side datatype support.   It also does not currently support
additional arguments, such as “CONTENT”, “DOCUMENT”,
“xml_schema_collection”.</p>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.dialects.mssql.XML.__init__"><span class="sig-name descname">__init__()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.dialects.mssql.XML" title="sqlalchemy.dialects.mssql.XML"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.XML</span></code></a> (<a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Text" title="sqlalchemy.types.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.types.Text</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.dialects.mssql.XML.__init__">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.dialects.mssql.XML"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.dialects.mssql.XML.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.dialects.mssql.XML.__init__" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="docutils literal notranslate"><span class="pre">sqlalchemy.types.String.__init__</span></code> <em>method of</em> <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal notranslate"><span class="pre">String</span></code></a></p>
</div>
<p>Create a string-holding type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.dialects.mssql.XML.params.length"></span><strong>length</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.XML.params.length">¶</a> – optional, a length for the column for use in
DDL and CAST expressions.  May be safely omitted if no <code class="docutils literal notranslate"><span class="pre">CREATE</span>
<span class="pre">TABLE</span></code> will be issued.  Certain databases may require a
<code class="docutils literal notranslate"><span class="pre">length</span></code> for use in DDL, and will raise an exception when
the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> DDL is issued if a <code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code>
with no length is included.  Whether the value is
interpreted as bytes or characters is database specific.</p></li>
<li><p><span class="target" id="sqlalchemy.dialects.mssql.XML.params.collation"></span><strong>collation</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.dialects.mssql.XML.params.collation">¶</a> – <p>Optional, a column-level collation for
use in DDL and CAST expressions.  Renders using the
COLLATE keyword supported by SQLite, MySQL, and PostgreSQL.
E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">cast</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">String</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;some string&#39;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="n">collation</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">))))</span>
<div class='show_sql_print'><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(:</span><span class="n">param_1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="n">utf8</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">anon_1</span>
</div></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases, the <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.Unicode" title="sqlalchemy.types.Unicode"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unicode</span></code></a> or <a class="reference internal" href="../core/type_basics.html#sqlalchemy.types.UnicodeText" title="sqlalchemy.types.UnicodeText"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnicodeText</span></code></a>
datatypes should be used for a <a class="reference internal" href="../core/metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> that expects
to store non-ascii data. These datatypes will ensure that the
correct types are used on the database.</p>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-sqlalchemy.dialects.mssql.pyodbc">
<span id="pyodbc"></span><span id="mssql-pyodbc"></span><h2>PyODBC<a class="headerlink" href="#module-sqlalchemy.dialects.mssql.pyodbc" title="Link to this heading">¶</a></h2>
<p>Support for the Microsoft SQL Server database via the PyODBC driver.</p>
<section id="dialect-mssql-pyodbc-url">
<h3>DBAPI<a class="headerlink" href="#dialect-mssql-pyodbc-url" title="Link to this heading">¶</a></h3>
<p>Documentation and download information (if applicable) for PyODBC is available at:
<a class="reference external" href="https://pypi.org/project/pyodbc/">https://pypi.org/project/pyodbc/</a></p>
</section>
<section id="dialect-mssql-pyodbc-connect">
<h3>Connecting<a class="headerlink" href="#dialect-mssql-pyodbc-connect" title="Link to this heading">¶</a></h3>
<p>Connect String:<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mssql</span><span class="o">+</span><span class="n">pyodbc</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">username</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">password</span><span class="o">&gt;@&lt;</span><span class="n">dsnname</span><span class="o">&gt;</span></pre></div>
</div>
</p>
</section>
<section id="connecting-to-pyodbc">
<h3>Connecting to PyODBC<a class="headerlink" href="#connecting-to-pyodbc" title="Link to this heading">¶</a></h3>
<p>The URL here is to be translated to PyODBC connection strings, as
detailed in <a class="reference external" href="https://code.google.com/p/pyodbc/wiki/ConnectionStrings">ConnectionStrings</a>.</p>
<section id="dsn-connections">
<h4>DSN Connections<a class="headerlink" href="#dsn-connections" title="Link to this heading">¶</a></h4>
<p>A DSN connection in ODBC means that a pre-existing ODBC datasource is
configured on the client machine.   The application then specifies the name
of this datasource, which encompasses details such as the specific ODBC driver
in use as well as the network address of the database.   Assuming a datasource
is configured on the client, a basic DSN-based connection looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mssql+pyodbc://scott:tiger@some_dsn&quot;</span><span class="p">)</span></pre></div>
</div>
<p>Which above, will pass the following connection string to PyODBC:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DSN</span><span class="o">=</span><span class="n">some_dsn</span><span class="p">;</span><span class="n">UID</span><span class="o">=</span><span class="n">scott</span><span class="p">;</span><span class="n">PWD</span><span class="o">=</span><span class="n">tiger</span></pre></div>
</div>
<p>If the username and password are omitted, the DSN form will also add
the <code class="docutils literal notranslate"><span class="pre">Trusted_Connection=yes</span></code> directive to the ODBC string.</p>
</section>
<section id="hostname-connections">
<h4>Hostname Connections<a class="headerlink" href="#hostname-connections" title="Link to this heading">¶</a></h4>
<p>Hostname-based connections are also supported by pyodbc.  These are often
easier to use than a DSN and have the additional advantage that the specific
database name to connect towards may be specified locally in the URL, rather
than it being fixed as part of a datasource configuration.</p>
<p>When using a hostname connection, the driver name must also be specified in the
query parameters of the URL.  As these names usually have spaces in them, the
name must be URL encoded which means using plus signs for spaces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mssql+pyodbc://scott:tiger@myhost:port/databasename?driver=ODBC+Driver+17+for+SQL+Server&quot;</span><span class="p">)</span></pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">driver</span></code> keyword is significant to the pyodbc dialect and must be
specified in lowercase.</p>
<p>Any other names passed in the query string are passed through in the pyodbc
connect string, such as <code class="docutils literal notranslate"><span class="pre">authentication</span></code>, <code class="docutils literal notranslate"><span class="pre">TrustServerCertificate</span></code>, etc.
Multiple keyword arguments must be separated by an ampersand (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>); these
will be translated to semicolons when the pyodbc connect string is generated
internally:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;mssql+pyodbc://scott:tiger@mssql2017:1433/test?&quot;</span>
    <span class="s2">&quot;driver=ODBC+Driver+18+for+SQL+Server&amp;TrustServerCertificate=yes&quot;</span>
    <span class="s2">&quot;&amp;authentication=ActiveDirectoryIntegrated&quot;</span>
<span class="p">)</span></pre></div>
</div>
<p>The equivalent URL can be constructed using <a class="reference internal" href="../core/engines.html#sqlalchemy.engine.URL" title="sqlalchemy.engine.URL"><code class="xref py py-class docutils literal notranslate"><span class="pre">URL</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.engine</span> <span class="kn">import</span> <span class="n">URL</span>
<span class="n">connection_url</span> <span class="o">=</span> <span class="n">URL</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="s2">&quot;mssql+pyodbc&quot;</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;scott&quot;</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="s2">&quot;tiger&quot;</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;mssql2017&quot;</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">1433</span><span class="p">,</span>
    <span class="n">database</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
    <span class="n">query</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;ODBC Driver 18 for SQL Server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;TrustServerCertificate&quot;</span><span class="p">:</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;authentication&quot;</span><span class="p">:</span> <span class="s2">&quot;ActiveDirectoryIntegrated&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span></pre></div>
</div>
</section>
<section id="pass-through-exact-pyodbc-string">
<h4>Pass through exact Pyodbc string<a class="headerlink" href="#pass-through-exact-pyodbc-string" title="Link to this heading">¶</a></h4>
<p>A PyODBC connection string can also be sent in pyodbc’s format directly, as
specified in <a class="reference external" href="https://github.com/mkleehammer/pyodbc/wiki/Connecting-to-databases">the PyODBC documentation</a>,
using the parameter <code class="docutils literal notranslate"><span class="pre">odbc_connect</span></code>.  A <a class="reference internal" href="../core/engines.html#sqlalchemy.engine.URL" title="sqlalchemy.engine.URL"><code class="xref py py-class docutils literal notranslate"><span class="pre">URL</span></code></a> object
can help make this easier:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.engine</span> <span class="kn">import</span> <span class="n">URL</span>
<span class="n">connection_string</span> <span class="o">=</span> <span class="s2">&quot;DRIVER={SQL Server Native Client 10.0};SERVER=dagger;DATABASE=test;UID=user;PWD=password&quot;</span>
<span class="n">connection_url</span> <span class="o">=</span> <span class="n">URL</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;mssql+pyodbc&quot;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;odbc_connect&quot;</span><span class="p">:</span> <span class="n">connection_string</span><span class="p">})</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">connection_url</span><span class="p">)</span></pre></div>
</div>
</section>
<section id="connecting-to-databases-with-access-tokens">
<span id="mssql-pyodbc-access-tokens"></span><h4>Connecting to databases with access tokens<a class="headerlink" href="#connecting-to-databases-with-access-tokens" title="Link to this heading">¶</a></h4>
<p>Some database servers are set up to only accept access tokens for login. For
example, SQL Server allows the use of Azure Active Directory tokens to connect
to databases. This requires creating a credential object using the
<code class="docutils literal notranslate"><span class="pre">azure-identity</span></code> library. More information about the authentication step can be
found in <a class="reference external" href="https://docs.microsoft.com/en-us/azure/developer/python/azure-sdk-authenticate?tabs=bash">Microsoft’s documentation</a>.</p>
<p>After getting an engine, the credentials need to be sent to <code class="docutils literal notranslate"><span class="pre">pyodbc.connect</span></code>
each time a connection is requested. One way to do this is to set up an event
listener on the engine that adds the credential token to the dialect’s connect
call. This is discussed more generally in <a class="reference internal" href="../core/engines.html#engines-dynamic-tokens"><span class="std std-ref">Generating dynamic authentication tokens</span></a>. For
SQL Server in particular, this is passed as an ODBC connection attribute with
a data structure <a class="reference external" href="https://docs.microsoft.com/en-us/sql/connect/odbc/using-azure-active-directory#authenticating-with-an-access-token">described by Microsoft</a>.</p>
<p>The following code snippet will create an engine that connects to an Azure SQL
database using Azure credentials:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">event</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.engine.url</span> <span class="kn">import</span> <span class="n">URL</span>
<span class="kn">from</span> <span class="nn">azure</span> <span class="kn">import</span> <span class="n">identity</span>

<span class="n">SQL_COPT_SS_ACCESS_TOKEN</span> <span class="o">=</span> <span class="mi">1256</span>  <span class="c1"># Connection option for access tokens, as defined in msodbcsql.h</span>
<span class="n">TOKEN_URL</span> <span class="o">=</span> <span class="s2">&quot;https://database.windows.net/&quot;</span>  <span class="c1"># The token URL for any Azure SQL database</span>

<span class="n">connection_string</span> <span class="o">=</span> <span class="s2">&quot;mssql+pyodbc://@my-server.database.windows.net/myDb?driver=ODBC+Driver+17+for+SQL+Server&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">connection_string</span><span class="p">)</span>

<span class="n">azure_credentials</span> <span class="o">=</span> <span class="n">identity</span><span class="o">.</span><span class="n">DefaultAzureCredential</span><span class="p">()</span>

<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="s2">&quot;do_connect&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">provide_token</span><span class="p">(</span><span class="n">dialect</span><span class="p">,</span> <span class="n">conn_rec</span><span class="p">,</span> <span class="n">cargs</span><span class="p">,</span> <span class="n">cparams</span><span class="p">):</span>
    <span class="c1"># remove the &quot;Trusted_Connection&quot; parameter that SQLAlchemy adds</span>
    <span class="n">cargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;;Trusted_Connection=Yes&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># create token credential</span>
    <span class="n">raw_token</span> <span class="o">=</span> <span class="n">azure_credentials</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="n">TOKEN_URL</span><span class="p">)</span><span class="o">.</span><span class="n">token</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-16-le&quot;</span><span class="p">)</span>
    <span class="n">token_struct</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;I</span><span class="si">{</span><span class="n">len</span><span class="p">(</span><span class="n">raw_token</span><span class="p">)</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">,</span> <span class="n">len</span><span class="p">(</span><span class="n">raw_token</span><span class="p">),</span> <span class="n">raw_token</span><span class="p">)</span>

    <span class="c1"># apply it to keyword arguments</span>
    <span class="n">cparams</span><span class="p">[</span><span class="s2">&quot;attrs_before&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">SQL_COPT_SS_ACCESS_TOKEN</span><span class="p">:</span> <span class="n">token_struct</span><span class="p">}</span></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Trusted_Connection</span></code> token is currently added by the SQLAlchemy
pyodbc dialect when no username or password is present.  This needs
to be removed per Microsoft’s
<a class="reference external" href="https://docs.microsoft.com/en-us/sql/connect/odbc/using-azure-active-directory#authenticating-with-an-access-token">documentation for Azure access tokens</a>,
stating that a connection string when using an access token must not contain
<code class="docutils literal notranslate"><span class="pre">UID</span></code>, <code class="docutils literal notranslate"><span class="pre">PWD</span></code>, <code class="docutils literal notranslate"><span class="pre">Authentication</span></code> or <code class="docutils literal notranslate"><span class="pre">Trusted_Connection</span></code> parameters.</p>
</div>
</section>
<section id="avoiding-transaction-related-exceptions-on-azure-synapse-analytics">
<span id="azure-synapse-ignore-no-transaction-on-rollback"></span><h4>Avoiding transaction-related exceptions on Azure Synapse Analytics<a class="headerlink" href="#avoiding-transaction-related-exceptions-on-azure-synapse-analytics" title="Link to this heading">¶</a></h4>
<p>Azure Synapse Analytics has a significant difference in its transaction
handling compared to plain SQL Server; in some cases an error within a Synapse
transaction can cause it to be arbitrarily terminated on the server side, which
then causes the DBAPI <code class="docutils literal notranslate"><span class="pre">.rollback()</span></code> method (as well as <code class="docutils literal notranslate"><span class="pre">.commit()</span></code>) to
fail. The issue prevents the usual DBAPI contract of allowing <code class="docutils literal notranslate"><span class="pre">.rollback()</span></code>
to pass silently if no transaction is present as the driver does not expect
this condition. The symptom of this failure is an exception with a message
resembling ‘No corresponding transaction found. (111214)’ when attempting to
emit a <code class="docutils literal notranslate"><span class="pre">.rollback()</span></code> after an operation had a failure of some kind.</p>
<p>This specific case can be handled by passing <code class="docutils literal notranslate"><span class="pre">ignore_no_transaction_on_rollback=True</span></code> to
the SQL Server dialect via the <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> function as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">connection_url</span><span class="p">,</span> <span class="n">ignore_no_transaction_on_rollback</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
<p>Using the above parameter, the dialect will catch <code class="docutils literal notranslate"><span class="pre">ProgrammingError</span></code>
exceptions raised during <code class="docutils literal notranslate"><span class="pre">connection.rollback()</span></code> and emit a warning
if the error message contains code <code class="docutils literal notranslate"><span class="pre">111214</span></code>, however will not raise
an exception.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.4.40: </span>Added the
<code class="docutils literal notranslate"><span class="pre">ignore_no_transaction_on_rollback=True</span></code> parameter.</p>
</div>
</section>
<section id="enable-autocommit-for-azure-sql-data-warehouse-dw-connections">
<h4>Enable autocommit for Azure SQL Data Warehouse (DW) connections<a class="headerlink" href="#enable-autocommit-for-azure-sql-data-warehouse-dw-connections" title="Link to this heading">¶</a></h4>
<p>Azure SQL Data Warehouse does not support transactions,
and that can cause problems with SQLAlchemy’s “autobegin” (and implicit
commit/rollback) behavior. We can avoid these problems by enabling autocommit
at both the pyodbc and engine levels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">connection_url</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">URL</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="s2">&quot;mssql+pyodbc&quot;</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;scott&quot;</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="s2">&quot;tiger&quot;</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;dw.azure.example.com&quot;</span><span class="p">,</span>
    <span class="n">database</span><span class="o">=</span><span class="s2">&quot;mydb&quot;</span><span class="p">,</span>
    <span class="n">query</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;ODBC Driver 17 for SQL Server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;autocommit&quot;</span><span class="p">:</span> <span class="s2">&quot;True&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">connection_url</span><span class="p">)</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span>
    <span class="n">isolation_level</span><span class="o">=</span><span class="s2">&quot;AUTOCOMMIT&quot;</span>
<span class="p">)</span></pre></div>
</div>
</section>
<section id="avoiding-sending-large-string-parameters-as-text-ntext">
<h4>Avoiding sending large string parameters as TEXT/NTEXT<a class="headerlink" href="#avoiding-sending-large-string-parameters-as-text-ntext" title="Link to this heading">¶</a></h4>
<p>By default, for historical reasons, Microsoft’s ODBC drivers for SQL Server
send long string parameters (greater than 4000 SBCS characters or 2000 Unicode
characters) as TEXT/NTEXT values. TEXT and NTEXT have been deprecated for many
years and are starting to cause compatibility issues with newer versions of
SQL_Server/Azure. For example, see <a class="reference external" href="https://github.com/mkleehammer/pyodbc/issues/835">this
issue</a>.</p>
<p>Starting with ODBC Driver 18 for SQL Server we can override the legacy
behavior and pass long strings as varchar(max)/nvarchar(max) using the
<code class="docutils literal notranslate"><span class="pre">LongAsMax=Yes</span></code> connection string parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">connection_url</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">URL</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="s2">&quot;mssql+pyodbc&quot;</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;scott&quot;</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="s2">&quot;tiger&quot;</span><span class="p">,</span>
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;mssqlserver.example.com&quot;</span><span class="p">,</span>
    <span class="n">database</span><span class="o">=</span><span class="s2">&quot;mydb&quot;</span><span class="p">,</span>
    <span class="n">query</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;ODBC Driver 18 for SQL Server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LongAsMax&quot;</span><span class="p">:</span> <span class="s2">&quot;Yes&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span></pre></div>
</div>
</section>
</section>
<section id="pyodbc-pooling-connection-close-behavior">
<h3>Pyodbc Pooling / connection close behavior<a class="headerlink" href="#pyodbc-pooling-connection-close-behavior" title="Link to this heading">¶</a></h3>
<p>PyODBC uses internal <a class="reference external" href="https://github.com/mkleehammer/pyodbc/wiki/The-pyodbc-Module#pooling">pooling</a> by
default, which means connections will be longer lived than they are within
SQLAlchemy itself.  As SQLAlchemy has its own pooling behavior, it is often
preferable to disable this behavior.  This behavior can only be disabled
globally at the PyODBC module level, <strong>before</strong> any connections are made:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyodbc</span>

<span class="n">pyodbc</span><span class="o">.</span><span class="n">pooling</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># don&#39;t use the engine before pooling is set to False</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mssql+pyodbc://user:pass@dsn&quot;</span><span class="p">)</span></pre></div>
</div>
<p>If this variable is left at its default value of <code class="docutils literal notranslate"><span class="pre">True</span></code>, <strong>the application
will continue to maintain active database connections</strong>, even when the
SQLAlchemy engine itself fully discards a connection or if the engine is
disposed.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://github.com/mkleehammer/pyodbc/wiki/The-pyodbc-Module#pooling">pooling</a> -
in the PyODBC documentation.</p>
</div>
</section>
<section id="driver-unicode-support">
<h3>Driver / Unicode Support<a class="headerlink" href="#driver-unicode-support" title="Link to this heading">¶</a></h3>
<p>PyODBC works best with Microsoft ODBC drivers, particularly in the area
of Unicode support on both Python 2 and Python 3.</p>
<p>Using the FreeTDS ODBC drivers on Linux or OSX with PyODBC is <strong>not</strong>
recommended; there have been historically many Unicode-related issues
in this area, including before Microsoft offered ODBC drivers for Linux
and OSX.   Now that Microsoft offers drivers for all platforms, for
PyODBC support these are recommended.  FreeTDS remains relevant for
non-ODBC drivers such as pymssql where it works very well.</p>
</section>
<section id="rowcount-support">
<h3>Rowcount Support<a class="headerlink" href="#rowcount-support" title="Link to this heading">¶</a></h3>
<p>Previous limitations with the SQLAlchemy ORM’s “versioned rows” feature with
Pyodbc have been resolved as of SQLAlchemy 2.0.5. See the notes at
<a class="reference internal" href="#mssql-rowcount-versioning"><span class="std std-ref">Rowcount Support / ORM Versioning</span></a>.</p>
</section>
<section id="fast-executemany-mode">
<span id="mssql-pyodbc-fastexecutemany"></span><h3>Fast Executemany Mode<a class="headerlink" href="#fast-executemany-mode" title="Link to this heading">¶</a></h3>
<p>The PyODBC driver includes support for a “fast executemany” mode of execution
which greatly reduces round trips for a DBAPI <code class="docutils literal notranslate"><span class="pre">executemany()</span></code> call when using
Microsoft ODBC drivers, for <strong>limited size batches that fit in memory</strong>.  The
feature is enabled by setting the attribute <code class="docutils literal notranslate"><span class="pre">.fast_executemany</span></code> on the DBAPI
cursor when an executemany call is to be used.   The SQLAlchemy PyODBC SQL
Server dialect supports this parameter by passing the
<code class="docutils literal notranslate"><span class="pre">fast_executemany</span></code> parameter to
<a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> , when using the <strong>Microsoft ODBC driver only</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;mssql+pyodbc://scott:tiger@mssql2017:1433/test?driver=ODBC+Driver+17+for+SQL+Server&quot;</span><span class="p">,</span>
    <span class="n">fast_executemany</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0.9: </span>- the <code class="docutils literal notranslate"><span class="pre">fast_executemany</span></code> parameter now has its
intended effect of this PyODBC feature taking effect for all INSERT
statements that are executed with multiple parameter sets, which don’t
include RETURNING.  Previously, SQLAlchemy 2.0’s <a class="reference internal" href="../glossary.html#term-insertmanyvalues"><span class="xref std std-term">insertmanyvalues</span></a>
feature would cause <code class="docutils literal notranslate"><span class="pre">fast_executemany</span></code> to not be used in most cases
even if specified.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://github.com/mkleehammer/pyodbc/wiki/Features-beyond-the-DB-API#fast_executemany">fast executemany</a>
- on github</p>
</div>
</section>
<section id="setinputsizes-support">
<span id="mssql-pyodbc-setinputsizes"></span><h3>Setinputsizes Support<a class="headerlink" href="#setinputsizes-support" title="Link to this heading">¶</a></h3>
<p>As of version 2.0, the pyodbc <code class="docutils literal notranslate"><span class="pre">cursor.setinputsizes()</span></code> method is used for
all statement executions, except for <code class="docutils literal notranslate"><span class="pre">cursor.executemany()</span></code> calls when
fast_executemany=True where it is not supported (assuming
<a class="reference internal" href="../core/connections.html#engine-insertmanyvalues"><span class="std std-ref">insertmanyvalues</span></a> is kept enabled,
“fastexecutemany” will not take place for INSERT statements in any case).</p>
<p>The use of <code class="docutils literal notranslate"><span class="pre">cursor.setinputsizes()</span></code> can be disabled by passing
<code class="docutils literal notranslate"><span class="pre">use_setinputsizes=False</span></code> to <a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">use_setinputsizes</span></code> is left at its default of <code class="docutils literal notranslate"><span class="pre">True</span></code>, the
specific per-type symbols passed to <code class="docutils literal notranslate"><span class="pre">cursor.setinputsizes()</span></code> can be
programmatically customized using the <a class="reference internal" href="../core/events.html#sqlalchemy.events.DialectEvents.do_setinputsizes" title="sqlalchemy.events.DialectEvents.do_setinputsizes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectEvents.do_setinputsizes()</span></code></a>
hook. See that method for usage examples.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0: </span>The mssql+pyodbc dialect now defaults to using
<code class="docutils literal notranslate"><span class="pre">use_setinputsizes=True</span></code> for all statement executions with the exception of
cursor.executemany() calls when fast_executemany=True.  The behavior can
be turned off by passing <code class="docutils literal notranslate"><span class="pre">use_setinputsizes=False</span></code> to
<a class="reference internal" href="../core/engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a>.</p>
</div>
</section>
</section>
<section id="module-sqlalchemy.dialects.mssql.pymssql">
<span id="pymssql"></span><h2>pymssql<a class="headerlink" href="#module-sqlalchemy.dialects.mssql.pymssql" title="Link to this heading">¶</a></h2>
<p>Support for the Microsoft SQL Server database via the pymssql driver.</p>
<section id="dialect-mssql-pymssql-connect">
<h3>Connecting<a class="headerlink" href="#dialect-mssql-pymssql-connect" title="Link to this heading">¶</a></h3>
<p>Connect String:<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mssql</span><span class="o">+</span><span class="n">pymssql</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">username</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">password</span><span class="o">&gt;@&lt;</span><span class="n">freetds_name</span><span class="o">&gt;/</span><span class="err">?</span><span class="n">charset</span><span class="o">=</span><span class="n">utf8</span></pre></div>
</div>
</p>
</section>
<p>pymssql is a Python module that provides a Python DBAPI interface around
<a class="reference external" href="https://www.freetds.org/">FreeTDS</a>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0.5: </span>pymssql was restored to SQLAlchemy’s continuous integration testing</p>
</div>
</section>
<section id="module-sqlalchemy.dialects.mssql.aioodbc">
<span id="aioodbc"></span><span id="mssql-aioodbc"></span><h2>aioodbc<a class="headerlink" href="#module-sqlalchemy.dialects.mssql.aioodbc" title="Link to this heading">¶</a></h2>
<p>Support for the Microsoft SQL Server database via the aioodbc driver.</p>
<section id="dialect-mssql-aioodbc-url">
<h3>DBAPI<a class="headerlink" href="#dialect-mssql-aioodbc-url" title="Link to this heading">¶</a></h3>
<p>Documentation and download information (if applicable) for aioodbc is available at:
<a class="reference external" href="https://pypi.org/project/aioodbc/">https://pypi.org/project/aioodbc/</a></p>
</section>
<section id="dialect-mssql-aioodbc-connect">
<h3>Connecting<a class="headerlink" href="#dialect-mssql-aioodbc-connect" title="Link to this heading">¶</a></h3>
<p>Connect String:<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mssql</span><span class="o">+</span><span class="n">aioodbc</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">username</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">password</span><span class="o">&gt;@&lt;</span><span class="n">dsnname</span><span class="o">&gt;</span></pre></div>
</div>
</p>
</section>
<p>Support for the SQL Server database in asyncio style, using the aioodbc
driver which itself is a thread-wrapper around pyodbc.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.0.23: </span>Added the mssql+aioodbc dialect which builds
on top of the pyodbc and general aio* dialect architecture.</p>
</div>
<p>Using a special asyncio mediation layer, the aioodbc dialect is usable
as the backend for the <a class="reference internal" href="../orm/extensions/asyncio.html"><span class="std std-ref">SQLAlchemy asyncio</span></a>
extension package.</p>
<p>Most behaviors and caveats for this driver are the same as that of the
pyodbc dialect used on SQL Server; see <a class="reference internal" href="#mssql-pyodbc"><span class="std std-ref">PyODBC</span></a> for general
background.</p>
<p>This dialect should normally be used only with the
<a class="reference internal" href="../orm/extensions/asyncio.html#sqlalchemy.ext.asyncio.create_async_engine" title="sqlalchemy.ext.asyncio.create_async_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_async_engine()</span></code></a> engine creation function; connection
styles are otherwise equivalent to those documented in the pyodbc section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.ext.asyncio</span> <span class="kn">import</span> <span class="n">create_async_engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_async_engine</span><span class="p">(</span>
    <span class="s2">&quot;mssql+aioodbc://scott:tiger@mssql2017:1433/test?&quot;</span>
    <span class="s2">&quot;driver=ODBC+Driver+18+for+SQL+Server&amp;TrustServerCertificate=yes&quot;</span>
<span class="p">)</span></pre></div>
</div>
</section>
</section>

    </div>

</div>

<div id="docs-bottom-navigation" class="docs-navigation-links, withsidebar">
        Previous:
        <a href="oracle.html" title="previous chapter">Oracle</a>
        Next:
        <a href="../faq/index.html" title="next chapter">Frequently Asked Questions</a>

    <div id="docs-copyright">
        &copy; <a href="../copyright.html">Copyright</a> 2007-2024, the SQLAlchemy authors and contributors.


    <p><b>flambé!</b> the dragon and <b><i>The Alchemist</i></b> image designs created and generously donated by <a href="https://github.com/vmalloc">Rotem Yaari</a>.</p>

        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 7.2.6.

    Documentation last generated: Mon Aug  5 19:31:00 2024 JST

    </div>
</div>

</div>



        
        

    <script type="text/javascript">
      document.documentElement.dataset.content_root = '../';

    </script>

    <!-- begin iterate through sphinx environment script_files -->
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script type="text/javascript" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/sphinx_highlight.js"></script>
        <script type="text/javascript" src="../_static/clipboard.min.js"></script>
        <script type="text/javascript" src="../_static/copybutton.js"></script>
    <!-- end iterate through sphinx environment script_files -->

    <script type="text/javascript" src="../_static/init.js"></script>


    </body>
</html>


